
/////////////////////////////////////////////////////////////
//
// Source file for BulletinBoard
//
//    This file is generated by RapidApp 1.2
//
//    This class is derived from BulletinBoardUI which 
//    implements the user interface created in 
//    RapidApp. This class contains virtual
//    functions that are called from the user interface.
//
//    When you modify this source, limit your changes to 
//    modifying the sections between the
//    "//---- Start/End editable code block" markers
//
//    This will allow RapidApp to integrate changes more easily
//
//    This class is a ViewKit user interface "component".
//    For more information on how components are used, see the
//    "ViewKit Programmers' Manual", and the RapidApp
//    User's Guide.
/////////////////////////////////////////////////////////////

#include "BulletinBoard.h"
#include <Vk/VkEZ.h>
#include <Xm/BulletinB.h> 
#include <Xm/LabelG.h> 
#include <Xm/List.h> 
#include <Xm/RowColumn.h> 
#include <Xm/Scale.h> 
#include <Xm/ScrolledW.h> 
#include <Xm/TextF.h> 
#include <Xm/ToggleB.h> 
#include <Vk/VkResource.h>
#include <Vk/VkOptionMenu.h>
#include <Vk/VkMenuItem.h>
#include <Vk/VkWindow.h>
#include <Vk/VkMenuBar.h>
#include <Vk/VkSubMenu.h>


extern void VkUnimplemented ( Widget, const char * );

///////////////////////////////////////////////////////////////////////////////
// The following non-container elements are created by BulletinBoardUI and are
// available as protected data members inherited by this class
//
//  XmTextField		    _meltThreshField
//  XmTextField		    _freezeThreshField
//  XmTextField		    _unpegThreshField
//  XmTextField		    _dampFactorField
//  XmTextField		    _refcntUAThreshField
//  XmLabelGadget		    _label22
//  VkOptionMenu *		    _optionMenu
//  VkMenuItem *		    _optionA
//  VkMenuItem *		    _optionB
//  XmTextField		    _unpegIntervalField
//  XmLabelGadget		    _label21
//  XmLabelGadget		    _label20
//  XmTextField		    _dampMLThreshField
//  XmScale		    _dampMLThreshScale
//  XmLabelGadget		    _label19
//  XmTextField		    _migrMinDisField
//  XmLabelGadget		    _label18
//  XmTextField		    _migrMAThreshField
//  XmLabelGadget		    _label17
//  XmLabelGadget		    _label16
//  XmScale		    _meltThreshScale
//  XmTextField		    _migrThreshField
//  XmScale		    _freezeThreshScale
//  XmScale		    _unpegThreshScale
//  XmScale		    _dampFactorScale
//  XmScale		    _migrThreshScale
//  XmLabelGadget		    _label15
//  XmLabelGadget		    _label14
//  XmLabelGadget		    _label13
//  XmLabelGadget		    _label12
//  XmLabelGadget		    _label11
//  XmToggleButton		    _meltTogOn
//  XmToggleButton		    _meltTogOff
//  XmLabelGadget		    _label10
//  XmToggleButton		    _freezeTogOn
//  XmToggleButton		    _freezeTogOff
//  XmLabelGadget		    _label9
//  XmLabelGadget		    _label8
//  XmLabelGadget		    _label7
//  XmLabelGadget		    _label6
//  XmLabelGadget		    _label5
//  XmLabelGadget		    _label4
//  XmLabelGadget		    _label3
//  XmLabelGadget		    _label2
//  XmLabelGadget		    _label1
//  XmLabelGadget		    _label
//  XmToggleButton		    _unpegTogOn
//  XmToggleButton		    _unpegTogOff
//  XmToggleButton		    _dampTogOn
//  XmToggleButton		    _dampTogOff
//  XmToggleButton		    _refcntTogOn
//  XmToggleButton		    _refcntTogOff
//  XmToggleButton		    _refcntTogNormOn
//  XmToggleButton		    _refcntTogNormOff
//  XmToggleButton		    _migrTogOn
//  XmToggleButton		    _migrTogOff
//  XmToggleButton		    _migrTogNormOn
//  XmToggleButton		    _migrTogNormOff
//  XmList		    _scrolledList
//
///////////////////////////////////////////////////////////////////////////////


//---- Start editable code block: headers and declarations
#include <assert.h>
#include <iostream.h>
#include <stdlib.h>
#include <stdio.h>
#include <sys/pmo.h>
#include <sys/syssgi.h>
#include <sys/migr_parms.h>
#include <Vk/VkFormat.h>
#include <Vk/VkDialogManager.h>
#include <Vk/VkErrorDialog.h>
#include <unistd.h>
#include <errno.h>

//---- End editable code block: headers and declarations

//---- BulletinBoard Constructor

BulletinBoard::BulletinBoard(const char *name, Widget parent) : 
                   BulletinBoardUI(name, parent) 
{ 
    // This constructor calls BulletinBoardUI(parent, name)
    // which calls BulletinBoardUI::create() to create
    // the widgets for this component. Any code added here
    // is called after the component's interface has been built

    //---- Start editable code block: BulletinBoard constructor
    //    XtVaSetValues(_toggle, XmNselectColor, red, NULL);

    // Get number of nodes
    if (syssgi(SGI_NUMA_TESTS, NUMNODES_GET, -1, &numNodes) < 0) {
      perror("SGI_NUMA_TESTS, NUMNODES_GET");
      exit(1);
    }
    nodeNames = new XmString[numNodes];
    getNodeNames();
    XtVaSetValues ( _scrolledList, XmNitems, nodeNames,
                    XmNitemCount, numNodes, NULL );
    positions = NULL;
    currentNode = NULL;
    selectFirst(parent, NULL);

    //    assert(XmStringGetLtoR(, XmFONTLIST_DEFAULT_TAG, &currentNode));
    
    //---- End editable code block: BulletinBoard constructor



}    // End Constructor



BulletinBoard::BulletinBoard(const char *name) : 
                   BulletinBoardUI(name) 
 { 
    // This constructor calls BulletinBoardUI(name)
    // which does not create any widgets. Usually, this
    // constructor is not used

    //---- Start editable code block: BulletinBoard constructor 2


    //---- End editable code block: BulletinBoard constructor 2



}    // End Constructor



BulletinBoard::~BulletinBoard()
{
    // The base class destructors are responsible for
    // destroying all widgets and objects used in this component.
    // Only additional items created directly in this class
    // need to be freed here.

    //---- Start editable code block: BulletinBoard destructor
    if(positions != NULL)
      free(positions);
    if(currentNode != NULL)
      XtFree(currentNode);

    //---- End editable code block: BulletinBoard destructor



}    // End Destructor


const char * BulletinBoard::className() // classname
{
    return ("BulletinBoard");
} // End className()


void BulletinBoard::VehicleBTE ( Widget w, XtPointer callData )
{
    //---- Start editable code block: BulletinBoard VehicleBTE

    generalCallback(w, VEHICLE_BTE);
    return;

    XmPushButtonCallbackStruct *cbs = (XmPushButtonCallbackStruct*) callData;
    migr_parms_t local_mp;
    
    if (syssgi(SGI_NUMA_TUNE, MIGR_PARMS_GET, currentNode, &local_mp) < 0) {
      showError();
    }
    
    local_mp.migr_system_kparms.migr_vehicle = 0;
    if (syssgi(SGI_NUMA_TUNE, MIGR_PARMS_SET, currentNode, &local_mp) < 0) {
      showError();
    }

    Update();

    //---- End editable code block: BulletinBoard VehicleBTE

}    // End BulletinBoard::VehicleBTE()


void BulletinBoard::VehicleTLBsync ( Widget w, XtPointer callData )
{
    //---- Start editable code block: BulletinBoard VehicleTLBsync

    generalCallback(w, VEHICLE_TLBSYNC);
    return;

    XmPushButtonCallbackStruct *cbs = (XmPushButtonCallbackStruct*) callData;
    migr_parms_t local_mp;
    
    if (syssgi(SGI_NUMA_TUNE, MIGR_PARMS_GET, currentNode, &local_mp) < 0) {
      showError();
    }
    
    local_mp.migr_system_kparms.migr_vehicle = 1;
    if (syssgi(SGI_NUMA_TUNE, MIGR_PARMS_SET, currentNode, &local_mp) < 0) {
      showError();
    }

    Update();

    //---- End editable code block: BulletinBoard VehicleTLBsync

}    // End BulletinBoard::VehicleTLBsync()


void BulletinBoard::dampFactorFieldChanged ( Widget w, XtPointer callData )
{
    //---- Start editable code block: BulletinBoard dampFactorFieldChanged

    generalCallback(w, DAMP_FACTOR_FIELD);
    return;

    XmAnyCallbackStruct *cbs = (XmAnyCallbackStruct*) callData;
    migr_parms_t local_mp;
    int val = atoi(XmTextFieldGetString(w));;
    
    if(val >= 0 && val <= 100) {
      if (syssgi(SGI_NUMA_TUNE, MIGR_PARMS_GET, currentNode, &local_mp) < 0) {
	showError();
      }
      
      local_mp.migr_as_kparms.migr_dampening_factor = atoi(XmTextFieldGetString(w));
      if (syssgi(SGI_NUMA_TUNE, MIGR_PARMS_SET, currentNode, &local_mp) < 0) {
	showError();
      }
    }

    Update();

    //---- End editable code block: BulletinBoard dampFactorFieldChanged

}    // End BulletinBoard::dampFactorFieldChanged()


void BulletinBoard::dampFactorScaleChanged ( Widget w, XtPointer callData )
{
    //---- Start editable code block: BulletinBoard dampFactorScaleChanged

    generalCallback(w, DAMP_FACTOR_SCALE);
    return;

    XmScaleCallbackStruct *cbs = (XmScaleCallbackStruct*) callData;
    migr_parms_t local_mp;
    int val;

    if (syssgi(SGI_NUMA_TUNE, MIGR_PARMS_GET, currentNode, &local_mp) < 0) {
      showError();
    }
    
    XmScaleGetValue(w, &val);
    local_mp.migr_as_kparms.migr_dampening_factor = val;
    if (syssgi(SGI_NUMA_TUNE, MIGR_PARMS_SET, currentNode, &local_mp) < 0) {
      showError();
    }

    Update();

    //---- End editable code block: BulletinBoard dampFactorScaleChanged

}    // End BulletinBoard::dampFactorScaleChanged()

void BulletinBoard::dampFactorScaleDynamic ( Widget w, XtPointer callData )
{
    //---- Start editable code block: BulletinBoard dampFactorScaleDynamic

    XmScaleCallbackStruct *cbs = (XmScaleCallbackStruct*) callData;
    int val;
    XmScaleGetValue(w, &val);
    XmTextFieldSetString(_dampFactorField, (char *)VkFormat("%d", val));

    //---- End editable code block: BulletinBoard dampFactorScaleDynamic

}    // End BulletinBoard::dampFactorScaleDynamic()

void BulletinBoard::dampMLThreshFieldChanged ( Widget w, XtPointer callData )
{
    //---- Start editable code block: BulletinBoard dampMLThreshFieldChanged

    generalCallback(w, DAMP_MLTHRESH_FIELD);
    return;

    XmAnyCallbackStruct *cbs = (XmAnyCallbackStruct*) callData;
    migr_parms_t local_mp;
    int val = atoi(XmTextFieldGetString(w));;
    
    if(val >= 0 && val <= 100) {
      if (syssgi(SGI_NUMA_TUNE, MIGR_PARMS_GET, currentNode, &local_mp) < 0) {
	showError();
      }
      
      local_mp.migr_system_kparms.migr_memory_low_threshold = atoi(XmTextFieldGetString(w));
      if (syssgi(SGI_NUMA_TUNE, MIGR_PARMS_SET, currentNode, &local_mp) < 0) {
	showError();
      }
    }

    Update();

    //---- End editable code block: BulletinBoard dampMLThreshFieldChanged

}    // End BulletinBoard::dampMLThreshFieldChanged()


void BulletinBoard::dampMLThreshScaleChanged ( Widget w, XtPointer callData )
{
    //---- Start editable code block: BulletinBoard dampMLThreshScaleChanged

    generalCallback(w, DAMP_MLTHRESH_SCALE);
    return;

    XmScaleCallbackStruct *cbs = (XmScaleCallbackStruct*) callData;
    migr_parms_t local_mp;
    int val;

    if (syssgi(SGI_NUMA_TUNE, MIGR_PARMS_GET, currentNode, &local_mp) < 0) {
      showError();
    }
    
    XmScaleGetValue(w, &val);
    local_mp.migr_system_kparms.migr_memory_low_threshold = val;
    if (syssgi(SGI_NUMA_TUNE, MIGR_PARMS_SET, currentNode, &local_mp) < 0) {
      showError();
    }

    Update();

    //---- End editable code block: BulletinBoard dampMLThreshScaleChanged

}    // End BulletinBoard::dampMLThreshScaleChanged()


void BulletinBoard::dampMLThreshScaleDynamic ( Widget w, XtPointer callData )
{
    //---- Start editable code block: BulletinBoard dampMLThreshScaleDynamic

    XmScaleCallbackStruct *cbs = (XmScaleCallbackStruct*) callData;
    int val;
    XmScaleGetValue(w, &val);
    XmTextFieldSetString(_dampMLThreshField, (char *)VkFormat("%d", val));

    //---- End editable code block: BulletinBoard dampMLThreshScaleDynamic

}    // End BulletinBoard::dampMLThreshScaleDynamic()


void BulletinBoard::dampSetOff ( Widget w, XtPointer callData )
{
    //---- Start editable code block: BulletinBoard dampSetOff

    generalCallback(w, DAMP_SET_OFF);
    return;

    if(!XmToggleButtonGetState(w))
      return;

    XmToggleButtonCallbackStruct *cbs = (XmToggleButtonCallbackStruct*) callData;
    migr_parms_t local_mp;

    if (syssgi(SGI_NUMA_TUNE, MIGR_PARMS_GET, currentNode, &local_mp) < 0) {
      showError();
    }
    
    local_mp.migr_as_kparms.migr_dampening_enabled = 0;
    if (syssgi(SGI_NUMA_TUNE, MIGR_PARMS_SET, currentNode, &local_mp) < 0) {
      showError();
    }

    Update();

    //---- End editable code block: BulletinBoard dampSetOff

}    // End BulletinBoard::dampSetOff()


void BulletinBoard::dampSetOn ( Widget w, XtPointer callData )
{
    //---- Start editable code block: BulletinBoard dampSetOn

    generalCallback(w, DAMP_SET_ON);
    return;

    if(!XmToggleButtonGetState(w))
      return;

    XmToggleButtonCallbackStruct *cbs = (XmToggleButtonCallbackStruct*) callData;
    migr_parms_t local_mp;

    if (syssgi(SGI_NUMA_TUNE, MIGR_PARMS_GET, currentNode, &local_mp) < 0) {
      showError();
    }
    
    local_mp.migr_as_kparms.migr_dampening_enabled = 1;
    if (syssgi(SGI_NUMA_TUNE, MIGR_PARMS_SET, currentNode, &local_mp) < 0) {
      showError();
    }

    Update();

    //---- End editable code block: BulletinBoard dampSetOn

}    // End BulletinBoard::dampSetOn()


void BulletinBoard::freezeSetOff ( Widget w, XtPointer callData )
{
    //---- Start editable code block: BulletinBoard freezeSetOff

    generalCallback(w, FREEZE_SET_OFF);
    return;

    if(!XmToggleButtonGetState(w))
      return;

    XmToggleButtonCallbackStruct *cbs = (XmToggleButtonCallbackStruct*) callData;
    migr_parms_t local_mp;

    if (syssgi(SGI_NUMA_TUNE, MIGR_PARMS_GET, currentNode, &local_mp) < 0) {
      showError();
    }
    
    local_mp.migr_as_kparms.migr_freeze_enabled = 0;
    if (syssgi(SGI_NUMA_TUNE, MIGR_PARMS_SET, currentNode, &local_mp) < 0) {
      showError();
    }

    Update();

    //---- End editable code block: BulletinBoard freezeSetOff

}    // End BulletinBoard::freezeSetOff()


void BulletinBoard::freezeSetOn ( Widget w, XtPointer callData )
{
    //---- Start editable code block: BulletinBoard freezeSetOn

    generalCallback(w, FREEZE_SET_ON);
    return;

    if(!XmToggleButtonGetState(w))
      return;

    XmToggleButtonCallbackStruct *cbs = (XmToggleButtonCallbackStruct*) callData;
    migr_parms_t local_mp;

    if (syssgi(SGI_NUMA_TUNE, MIGR_PARMS_GET, currentNode, &local_mp) < 0) {
      showError();
    }
    
    local_mp.migr_as_kparms.migr_freeze_enabled = 1;
    if (syssgi(SGI_NUMA_TUNE, MIGR_PARMS_SET, currentNode, &local_mp) < 0) {
      showError();
    }

    Update();

    //---- End editable code block: BulletinBoard freezeSetOn

}    // End BulletinBoard::freezeSetOn()


void BulletinBoard::freezeThreshFieldChanged ( Widget w, XtPointer callData )
{
    //---- Start editable code block: BulletinBoard freezeThreshFieldChanged

    generalCallback(w, FREEZE_THRESH_FIELD);
    return;

    XmAnyCallbackStruct *cbs = (XmAnyCallbackStruct*) callData;
    migr_parms_t local_mp;
    int val = atoi(XmTextFieldGetString(w));;
    
    if(val >= 0 && val <= 100) {
      if (syssgi(SGI_NUMA_TUNE, MIGR_PARMS_GET, currentNode, &local_mp) < 0) {
	showError();
      }
      
      local_mp.migr_as_kparms.migr_freeze_threshold = atoi(XmTextFieldGetString(w));
      if (syssgi(SGI_NUMA_TUNE, MIGR_PARMS_SET, currentNode, &local_mp) < 0) {
	showError();
      }
    }

    Update();

    //---- End editable code block: BulletinBoard freezeThreshFieldChanged

}    // End BulletinBoard::freezeThreshFieldChanged()


void BulletinBoard::freezeThreshScaleChanged ( Widget w, XtPointer callData )
{
    //---- Start editable code block: BulletinBoard freezeThreshScaleChanged

    generalCallback(w, FREEZE_THRESH_SCALE);
    return;

    XmScaleCallbackStruct *cbs = (XmScaleCallbackStruct*) callData;
    migr_parms_t local_mp;
    int val;

    if (syssgi(SGI_NUMA_TUNE, MIGR_PARMS_GET, currentNode, &local_mp) < 0) {
      showError();
    }
    
    XmScaleGetValue(w, &val);
    local_mp.migr_as_kparms.migr_freeze_threshold = val;
    if (syssgi(SGI_NUMA_TUNE, MIGR_PARMS_SET, currentNode, &local_mp) < 0) {
      showError();
    }

    Update();

    //---- End editable code block: BulletinBoard freezeThreshScaleChanged

}    // End BulletinBoard::freezeThreshScaleChanged()

void BulletinBoard::freezeThreshScaleDynamic ( Widget w, XtPointer callData )
{
    //---- Start editable code block: BulletinBoard freezeThreshScaleDynamic

    XmScaleCallbackStruct *cbs = (XmScaleCallbackStruct*) callData;
    int val;
    XmScaleGetValue(w, &val);
    XmTextFieldSetString(_freezeThreshField, (char *)VkFormat("%d", val));

    //---- End editable code block: BulletinBoard freezeThreshScaleDynamic

}    // End BulletinBoard::freezeThreshScaleDynamic()

void BulletinBoard::meltSetOff ( Widget w, XtPointer callData )
{
    //---- Start editable code block: BulletinBoard meltSetOff

    generalCallback(w, MELT_SET_OFF);
    return;

    if(!XmToggleButtonGetState(w))
      return;

    XmToggleButtonCallbackStruct *cbs = (XmToggleButtonCallbackStruct*) callData;
    migr_parms_t local_mp;

    if (syssgi(SGI_NUMA_TUNE, MIGR_PARMS_GET, currentNode, &local_mp) < 0) {
      showError();
    }
    
    local_mp.migr_as_kparms.migr_melt_enabled = 0;
    if (syssgi(SGI_NUMA_TUNE, MIGR_PARMS_SET, currentNode, &local_mp) < 0) {
      showError();
    }

    Update();

    //---- End editable code block: BulletinBoard meltSetOff

}    // End BulletinBoard::meltSetOff()


void BulletinBoard::meltSetOn ( Widget w, XtPointer callData )
{
    //---- Start editable code block: BulletinBoard meltSetOn

    generalCallback(w, MELT_SET_ON);
    return;

    if(!XmToggleButtonGetState(w))
      return;

    XmToggleButtonCallbackStruct *cbs = (XmToggleButtonCallbackStruct*) callData;
    migr_parms_t local_mp;

    if (syssgi(SGI_NUMA_TUNE, MIGR_PARMS_GET, currentNode, &local_mp) < 0) {
      showError();
    }
    
    local_mp.migr_as_kparms.migr_melt_enabled = 1;
    if (syssgi(SGI_NUMA_TUNE, MIGR_PARMS_SET, currentNode, &local_mp) < 0) {
      showError();
    }

    Update();

    //---- End editable code block: BulletinBoard meltSetOn

}    // End BulletinBoard::meltSetOn()


void BulletinBoard::meltThreshFieldChanged ( Widget w, XtPointer callData )
{
    //---- Start editable code block: BulletinBoard meltThreshFieldChanged

    generalCallback(w, MELT_THRESH_FIELD);
    return;

    XmAnyCallbackStruct *cbs = (XmAnyCallbackStruct*) callData;
    migr_parms_t local_mp;
    int val = atoi(XmTextFieldGetString(w));;
    
    if(val >= 0 && val <= 100) {
      if (syssgi(SGI_NUMA_TUNE, MIGR_PARMS_GET, currentNode, &local_mp) < 0) {
	showError();
      }
      
      local_mp.migr_as_kparms.migr_melt_threshold = atoi(XmTextFieldGetString(w));
      if (syssgi(SGI_NUMA_TUNE, MIGR_PARMS_SET, currentNode, &local_mp) < 0) {
	showError();
      }
    }

    Update();

    //---- End editable code block: BulletinBoard meltThreshFieldChanged

}    // End BulletinBoard::meltThreshFieldChanged()


void BulletinBoard::meltThreshScaleChanged ( Widget w, XtPointer callData )
{
    //---- Start editable code block: BulletinBoard meltThreshScaleChanged

    generalCallback(w, MELT_THRESH_SCALE);
    return;

    XmScaleCallbackStruct *cbs = (XmScaleCallbackStruct*) callData;
    migr_parms_t local_mp;
    int val;

    if (syssgi(SGI_NUMA_TUNE, MIGR_PARMS_GET, currentNode, &local_mp) < 0) {
      showError();
    }
    
    XmScaleGetValue(w, &val);
    local_mp.migr_as_kparms.migr_melt_threshold = val;
    if (syssgi(SGI_NUMA_TUNE, MIGR_PARMS_SET, currentNode, &local_mp) < 0) {
      showError();
    }

    Update();

    //---- End editable code block: BulletinBoard meltThreshScaleChanged

}    // End BulletinBoard::meltThreshScaleChanged()

void BulletinBoard::meltThreshScaleDynamic ( Widget w, XtPointer callData )
{
    //---- Start editable code block: BulletinBoard meltThreshScaleDynamic

    XmScaleCallbackStruct *cbs = (XmScaleCallbackStruct*) callData;
    int val;
    XmScaleGetValue(w, &val);
    XmTextFieldSetString(_meltThreshField, (char *)VkFormat("%d", val));

    //---- End editable code block: BulletinBoard meltThreshScaleDynamic

}    // End BulletinBoard::meltThreshScaleDynamic()

void BulletinBoard::migrMAThreshFieldChanged ( Widget w, XtPointer callData )
{
    //---- Start editable code block: BulletinBoard migrMAThreshFieldChanged

    generalCallback(w, MIGR_MATHRESH_FIELD);
    return;

    XmAnyCallbackStruct *cbs = (XmAnyCallbackStruct*) callData;
    migr_parms_t local_mp;
    int val = atoi(XmTextFieldGetString(w));;
    
    if(val >= 0 && val <= 9999) {
      if (syssgi(SGI_NUMA_TUNE, MIGR_PARMS_GET, currentNode, &local_mp) < 0) {
	showError();
      }
      
      local_mp.migr_system_kparms.migr_threshold_reference = atoi(XmTextFieldGetString(w));
      if (syssgi(SGI_NUMA_TUNE, MIGR_PARMS_SET, currentNode, &local_mp) < 0) {
	showError();
      }
    }

    Update();

    //---- End editable code block: BulletinBoard migrMAThreshFieldChanged

}    // End BulletinBoard::migrMAThreshFieldChanged()


void BulletinBoard::migrMinDisFieldChanged ( Widget w, XtPointer callData )
{
    //---- Start editable code block: BulletinBoard migrMinDisFieldChanged

    generalCallback(w, MIGR_MINDIS_FIELD);
    return;

    XmAnyCallbackStruct *cbs = (XmAnyCallbackStruct*) callData;
    migr_parms_t local_mp;
    int val = atoi(XmTextFieldGetString(w));;
    
    if(val >= 0 && val <= 20) {
      if (syssgi(SGI_NUMA_TUNE, MIGR_PARMS_GET, currentNode, &local_mp) < 0) {
	showError();
      }
      
      local_mp.migr_as_kparms.migr_min_distance = atoi(XmTextFieldGetString(w));
      if (syssgi(SGI_NUMA_TUNE, MIGR_PARMS_SET, currentNode, &local_mp) < 0) {
	showError();
      }
    }

    Update();

    //---- End editable code block: BulletinBoard migrMinDisFieldChanged

}    // End BulletinBoard::migrMinDisFieldChanged()


void BulletinBoard::migrSetNormOff ( Widget w, XtPointer callData )
{
    //---- Start editable code block: BulletinBoard migrSetNormOff

    generalCallback(w, MIGR_SET_NORMOFF);
    return;

    if(!XmToggleButtonGetState(w))
      return;

    XmToggleButtonCallbackStruct *cbs = (XmToggleButtonCallbackStruct*) callData;
    migr_parms_t local_mp;

    if (syssgi(SGI_NUMA_TUNE, MIGR_PARMS_GET, currentNode, &local_mp) < 0) {
      showError();
    }
    
    local_mp.migr_as_kparms.migr_base_mode = MIGRATION_MODE_OFF;
    if (syssgi(SGI_NUMA_TUNE, MIGR_PARMS_SET, currentNode, &local_mp) < 0) {
      showError();
    }

    Update();

    //---- End editable code block: BulletinBoard migrSetNormOff

}    // End BulletinBoard::migrSetNormOff()


void BulletinBoard::migrSetNormOn ( Widget w, XtPointer callData )
{
    //---- Start editable code block: BulletinBoard migrSetNormOn

    generalCallback(w, MIGR_SET_NORMON);
    return;

    if(!XmToggleButtonGetState(w))
      return;

    XmToggleButtonCallbackStruct *cbs = (XmToggleButtonCallbackStruct*) callData;
    migr_parms_t local_mp;

    if (syssgi(SGI_NUMA_TUNE, MIGR_PARMS_GET, currentNode, &local_mp) < 0) {
      showError();
    }
    
    local_mp.migr_as_kparms.migr_base_mode = MIGRATION_MODE_ON;
    if (syssgi(SGI_NUMA_TUNE, MIGR_PARMS_SET, currentNode, &local_mp) < 0) {
      showError();
    }

    Update();

    //---- End editable code block: BulletinBoard migrSetNormOn

}    // End BulletinBoard::migrSetNormOn()


void BulletinBoard::migrSetOff ( Widget w, XtPointer callData )
{
    //---- Start editable code block: BulletinBoard migrSetOff

    generalCallback(w, MIGR_SET_OFF);
    return;

    if(!XmToggleButtonGetState(w))
      return;

    XmToggleButtonCallbackStruct *cbs = (XmToggleButtonCallbackStruct*) callData;
    migr_parms_t local_mp;

    if (syssgi(SGI_NUMA_TUNE, MIGR_PARMS_GET, currentNode, &local_mp) < 0) {
      showError();
    }
    
    local_mp.migr_as_kparms.migr_base_mode = MIGRATION_MODE_DIS;
    if (syssgi(SGI_NUMA_TUNE, MIGR_PARMS_SET, currentNode, &local_mp) < 0) {
      showError();
    }

    Update();

    //---- End editable code block: BulletinBoard migrSetOff

}    // End BulletinBoard::migrSetOff()


void BulletinBoard::migrSetOn ( Widget w, XtPointer callData )
{
    //---- Start editable code block: BulletinBoard migrSetOn

    generalCallback(w, MIGR_SET_ON);
    return;

    if(!XmToggleButtonGetState(w))
      return;

    XmToggleButtonCallbackStruct *cbs = (XmToggleButtonCallbackStruct*) callData;
    migr_parms_t local_mp;

    if (syssgi(SGI_NUMA_TUNE, MIGR_PARMS_GET, currentNode, &local_mp) < 0) {
      showError();
    }
    
    local_mp.migr_as_kparms.migr_base_mode = MIGRATION_MODE_EN;
    if (syssgi(SGI_NUMA_TUNE, MIGR_PARMS_SET, currentNode, &local_mp) < 0) {
      showError();
    }

    Update();

    //---- End editable code block: BulletinBoard migrSetOn

}    // End BulletinBoard::migrSetOn()


void BulletinBoard::migrThreshFieldChanged ( Widget w, XtPointer callData )
{
    //---- Start editable code block: BulletinBoard migrThreshFieldChanged

    generalCallback(w, MIGR_THRESH_FIELD);
    return;

    XmAnyCallbackStruct *cbs = (XmAnyCallbackStruct*) callData;
    migr_parms_t local_mp;
    int val = atoi(XmTextFieldGetString(w));;
    
    if(val >= 0 && val <= 100) {
      if (syssgi(SGI_NUMA_TUNE, MIGR_PARMS_GET, currentNode, &local_mp) < 0) {
	showError();
      }
      
      local_mp.migr_as_kparms.migr_base_threshold = atoi(XmTextFieldGetString(w));
      if (syssgi(SGI_NUMA_TUNE, MIGR_PARMS_SET, currentNode, &local_mp) < 0) {
	showError();
      }
    }

    Update();

    //---- End editable code block: BulletinBoard migrThreshFieldChanged

}    // End BulletinBoard::migrThreshFieldChanged()


void BulletinBoard::migrThreshScaleChanged ( Widget w, XtPointer callData )
{
    //---- Start editable code block: BulletinBoard migrThreshScaleChanged

    generalCallback(w, MIGR_THRESH_SCALE);
    return;

    XmScaleCallbackStruct *cbs = (XmScaleCallbackStruct*) callData;
    migr_parms_t local_mp;
    int val;

    if (syssgi(SGI_NUMA_TUNE, MIGR_PARMS_GET, currentNode, &local_mp) < 0) {
      showError();
    }
    
    XmScaleGetValue(w, &val);
    local_mp.migr_as_kparms.migr_base_threshold = val;
    if (syssgi(SGI_NUMA_TUNE, MIGR_PARMS_SET, currentNode, &local_mp) < 0) {
      showError();
    }

    Update();

    //---- End editable code block: BulletinBoard migrThreshScaleChanged

}    // End BulletinBoard::migrThreshScaleChanged()

void BulletinBoard::migrThreshScaleDynamic ( Widget w, XtPointer callData )
{
    //---- Start editable code block: BulletinBoard migrThreshScaleDynamic

    XmScaleCallbackStruct *cbs = (XmScaleCallbackStruct*) callData;
    int val;
    XmScaleGetValue(w, &val);
    XmTextFieldSetString(_migrThreshField, (char *)VkFormat("%d", val));

    //---- End editable code block: BulletinBoard migrThreshScaleDynamic

}    // End BulletinBoard::migrThreshScaleDynamic()


void BulletinBoard::nodeSelect ( Widget w, XtPointer callData )
{
    //---- Start editable code block: BulletinBoard nodeSelect

    XmListCallbackStruct *cbs = (XmListCallbackStruct*) callData;

    if(positions != NULL)
      free(positions);
    XmListGetSelectedPos(w, &positions, &numPos);
    
    //for(int i=0; i < numPos; i++) {
    //  cout << positions[i] << endl;
    //}
    //cout << endl;
    
    if(numPos > 0)
      currentNodeNum = positions[0] - 1;
    else
      currentNodeNum = 0;

    if(currentNode != NULL)
      XtFree(currentNode);
    assert(XmStringGetLtoR(nodeNames[currentNodeNum], XmFONTLIST_DEFAULT_TAG, &currentNode));

    Update();

    // cout << currentNodeNum << endl;

    //---- End editable code block: BulletinBoard nodeSelect

}    // End BulletinBoard::nodeSelect()

void BulletinBoard::refcntSetNormOff ( Widget w, XtPointer callData )
{
    //---- Start editable code block: BulletinBoard refcntSetNormOff

    generalCallback(w, REFCNT_SET_NORMOFF);
    return;

    if(!XmToggleButtonGetState(w))
      return;

    XmToggleButtonCallbackStruct *cbs = (XmToggleButtonCallbackStruct*) callData;
    migr_parms_t local_mp;

    if (syssgi(SGI_NUMA_TUNE, MIGR_PARMS_GET, currentNode, &local_mp) < 0) {
      showError();
    }
    
    local_mp.migr_as_kparms.migr_refcnt_mode = REFCNT_MODE_OFF;
    if (syssgi(SGI_NUMA_TUNE, MIGR_PARMS_SET, currentNode, &local_mp) < 0) {
      showError();
    }

    Update();

    //---- End editable code block: BulletinBoard refcntSetNormOff

}    // End BulletinBoard::refcntSetNormOff()


void BulletinBoard::refcntSetNormOn ( Widget w, XtPointer callData )
{
    //---- Start editable code block: BulletinBoard refcntSetNormOn

    generalCallback(w, REFCNT_SET_NORMON);
    return;

    if(!XmToggleButtonGetState(w))
      return;

    XmToggleButtonCallbackStruct *cbs = (XmToggleButtonCallbackStruct*) callData;
    migr_parms_t local_mp;

    if (syssgi(SGI_NUMA_TUNE, MIGR_PARMS_GET, currentNode, &local_mp) < 0) {
      showError();
    }
    
    local_mp.migr_as_kparms.migr_refcnt_mode = REFCNT_MODE_ON;
    if (syssgi(SGI_NUMA_TUNE, MIGR_PARMS_SET, currentNode, &local_mp) < 0) {
      showError();
    }

    Update();

    //---- End editable code block: BulletinBoard refcntSetNormOn

}    // End BulletinBoard::refcntSetNormOn()


void BulletinBoard::refcntSetOff ( Widget w, XtPointer callData )
{
    //---- Start editable code block: BulletinBoard refcntSetOff

    generalCallback(w, REFCNT_SET_OFF);
    return;

    if(!XmToggleButtonGetState(w))
      return;

    XmToggleButtonCallbackStruct *cbs = (XmToggleButtonCallbackStruct*) callData;
    migr_parms_t local_mp;

    if (syssgi(SGI_NUMA_TUNE, MIGR_PARMS_GET, currentNode, &local_mp) < 0) {
      showError();
    }
    
    local_mp.migr_as_kparms.migr_refcnt_mode = REFCNT_MODE_DIS;
    if (syssgi(SGI_NUMA_TUNE, MIGR_PARMS_SET, currentNode, &local_mp) < 0) {
      showError();
    }

    Update();

    //---- End editable code block: BulletinBoard refcntSetOff

}    // End BulletinBoard::refcntSetOff()


void BulletinBoard::refcntSetOn ( Widget w, XtPointer callData )
{
    //---- Start editable code block: BulletinBoard refcntSetOn

    generalCallback(w, REFCNT_SET_ON);
    return;

    if(!XmToggleButtonGetState(w))
      return;

    XmToggleButtonCallbackStruct *cbs = (XmToggleButtonCallbackStruct*) callData;
    migr_parms_t local_mp;

    if (syssgi(SGI_NUMA_TUNE, MIGR_PARMS_GET, currentNode, &local_mp) < 0) {
      showError();
    }
    
    local_mp.migr_as_kparms.migr_refcnt_mode = REFCNT_MODE_EN;
    if (syssgi(SGI_NUMA_TUNE, MIGR_PARMS_SET, currentNode, &local_mp) < 0) {
      showError();
    }

    Update();

    //---- End editable code block: BulletinBoard refcntSetOn

}    // End BulletinBoard::refcntSetOn()


void BulletinBoard::refcntUAThreshFieldChanged ( Widget w, XtPointer callData )
{
    //---- Start editable code block: BulletinBoard refcntUAThreshFieldChanged

    generalCallback(w, REFCNT_UATHRESH_FIELD);
    return;

    XmAnyCallbackStruct *cbs = (XmAnyCallbackStruct*) callData;
    migr_parms_t local_mp;
    int val = atoi(XmTextFieldGetString(w));;
    
    if(val >= 0 && val <= 9999) {
      if (syssgi(SGI_NUMA_TUNE, MIGR_PARMS_GET, currentNode, &local_mp) < 0) {
	showError();
      }
      
      local_mp.migr_system_kparms.migr_effthreshold_refcnt_overflow = atoi(XmTextFieldGetString(w));
      if (syssgi(SGI_NUMA_TUNE, MIGR_PARMS_SET, currentNode, &local_mp) < 0) {
	showError();
      }
    }

    Update();

    //---- End editable code block: BulletinBoard refcntUAThreshFieldChanged

}    // End BulletinBoard::refcntUAThreshFieldChanged()


void BulletinBoard::unpegIntervalFieldChanged ( Widget w, XtPointer callData )
{
    //---- Start editable code block: BulletinBoard unpegIntervalFieldChanged

    generalCallback(w, UNPEG_INTERVAL_FIELD);
    return;

    XmAnyCallbackStruct *cbs = (XmAnyCallbackStruct*) callData;
    migr_parms_t local_mp;
    int val = atoi(XmTextFieldGetString(w));;
    
    if(val >= 0 && val <= 9999) {
      if (syssgi(SGI_NUMA_TUNE, MIGR_PARMS_GET, currentNode, &local_mp) < 0) {
	showError();
      }
      
      local_mp.migr_system_kparms.migr_unpegging_control_interval = atoi(XmTextFieldGetString(w));
      if (syssgi(SGI_NUMA_TUNE, MIGR_PARMS_SET, currentNode, &local_mp) < 0) {
	showError();
      }
    }

    Update();

    //---- End editable code block: BulletinBoard unpegIntervalFieldChanged

}    // End BulletinBoard::unpegIntervalFieldChanged()


void BulletinBoard::unpegSetOff ( Widget w, XtPointer callData )
{
    //---- Start editable code block: BulletinBoard unpegSetOff

    generalCallback(w, UNPEG_SET_OFF);
    return;

    if(!XmToggleButtonGetState(w))
      return;
    cout << "unpeg off" << endl;

    XmToggleButtonCallbackStruct *cbs = (XmToggleButtonCallbackStruct*) callData;
    migr_parms_t local_mp;

    if (syssgi(SGI_NUMA_TUNE, MIGR_PARMS_GET, currentNode, &local_mp) < 0) {
      showError();
    }
    
    local_mp.migr_system_kparms.migr_unpegging_control_enabled = 0;
    if (syssgi(SGI_NUMA_TUNE, MIGR_PARMS_SET, currentNode, &local_mp) < 0) {
      showError();
    }

    Update();

    //---- End editable code block: BulletinBoard unpegSetOff

}    // End BulletinBoard::unpegSetOff()


void BulletinBoard::unpegSetOn ( Widget w, XtPointer callData )
{
    //---- Start editable code block: BulletinBoard unpegSetOn

    generalCallback(w, UNPEG_SET_ON);
    return;

    if(!XmToggleButtonGetState(w))
      return;
    cout << "unpeg on" << endl;

    XmToggleButtonCallbackStruct *cbs = (XmToggleButtonCallbackStruct*) callData;
    migr_parms_t local_mp;

    if (syssgi(SGI_NUMA_TUNE, MIGR_PARMS_GET, currentNode, &local_mp) < 0) {
      showError();
    }
    
    local_mp.migr_system_kparms.migr_unpegging_control_enabled = 1;
    if (syssgi(SGI_NUMA_TUNE, MIGR_PARMS_SET, currentNode, &local_mp) < 0) {
      showError();
    }

    Update();

    //---- End editable code block: BulletinBoard unpegSetOn

}    // End BulletinBoard::unpegSetOn()


void BulletinBoard::unpegThreshFieldChanged ( Widget w, XtPointer callData )
{
    //---- Start editable code block: BulletinBoard unpegThreshFieldChanged

    generalCallback(w, UNPEG_THRESH_FIELD);
    return;

    XmAnyCallbackStruct *cbs = (XmAnyCallbackStruct*) callData;
    migr_parms_t local_mp;
    int val = atoi(XmTextFieldGetString(w));;
    
    if(val >= 0 && val <= 100) {
      if (syssgi(SGI_NUMA_TUNE, MIGR_PARMS_GET, currentNode, &local_mp) < 0) {
	showError();
      }
      
      local_mp.migr_system_kparms.migr_unpegging_control_threshold = atoi(XmTextFieldGetString(w));
      if (syssgi(SGI_NUMA_TUNE, MIGR_PARMS_SET, currentNode, &local_mp) < 0) {
	showError();
      }
    }

    Update();

    //---- End editable code block: BulletinBoard unpegThreshFieldChanged

}    // End BulletinBoard::unpegThreshFieldChanged()


void BulletinBoard::unpegThreshScaleChanged ( Widget w, XtPointer callData )
{
    //---- Start editable code block: BulletinBoard unpegThreshScaleChanged

    generalCallback(w, UNPEG_THRESH_SCALE);
    return;

    XmScaleCallbackStruct *cbs = (XmScaleCallbackStruct*) callData;
    migr_parms_t local_mp;
    int val;

    if (syssgi(SGI_NUMA_TUNE, MIGR_PARMS_GET, currentNode, &local_mp) < 0) {
      showError();
    }
    
    XmScaleGetValue(w, &val);
    local_mp.migr_system_kparms.migr_unpegging_control_threshold = val;
    if (syssgi(SGI_NUMA_TUNE, MIGR_PARMS_SET, currentNode, &local_mp) < 0) {
      showError();
    }

    Update();

    //---- End editable code block: BulletinBoard unpegThreshScaleChanged

}    // End BulletinBoard::unpegThreshScaleChanged()


void BulletinBoard::unpegThreshScaleDynamic ( Widget w, XtPointer callData )
{
    //---- Start editable code block: BulletinBoard unpegThreshScaleDynamic

    XmScaleCallbackStruct *cbs = (XmScaleCallbackStruct*) callData;
    int val;
    XmScaleGetValue(w, &val);
    XmTextFieldSetString(_unpegThreshField, (char *)VkFormat("%d", val));

    //---- End editable code block: BulletinBoard unpegThreshScaleDynamic

}    // End BulletinBoard::unpegThreshScaleDynamic()


void BulletinBoard::selectAll( Widget w, XtPointer callData )
{
    //---- Start editable code block: BulletinBoard selectAll

    if(numNodes == 0)
      return;

    XmListDeselectAllItems(_scrolledList);

    // Select all but the last node
    for(int i = 1; i < numNodes; i++)
      XmListSelectPos(_scrolledList, i, FALSE);

    // Select the last node and invoke the callback
    XmListSelectPos(_scrolledList, numNodes, TRUE);
    
    //---- End editable code block: BulletinBoard selectAll

}    // End BulletinBoard::selectAll()


void BulletinBoard::selectFirst( Widget w, XtPointer callData )
{
    //---- Start editable code block: BulletinBoard selectFirst

    if(numNodes == 0)
      return;
    
    XmListDeselectAllItems(_scrolledList);
    XmListSelectPos(_scrolledList, 1, TRUE);

    //---- End editable code block: BulletinBoard selectFirst

}    // End BulletinBoard::selectFirst()





///////////////////////////////////////////////////////////////////
// static creation function, for importing class into rapidapp
// or dynamically loading, using VkComponent::loadComponent
///////////////////////////////////////////////////////////////////


VkComponent *BulletinBoard::CreateBulletinBoard( const char *name, Widget parent ) 
{  
    VkComponent *obj =  new BulletinBoard ( name, parent );
    return ( obj );
} // End CreateBulletinBoard


///////////////////////////////////////////////////////////////////
// Function for accessing a description of the dynamic interface
// to this class.
///////////////////////////////////////////////////////////////////


// WARNING: This structure is different than that used with 1.1 RapidApp.
// See the RapidApp release notes for details

struct InterfaceMap {
  char  *resourceName;
  char  *methodName;
  char  *argType;
  char  *definingClass; // Optional, if not this class
  void (VkCallbackObject::*method)(...); // Reserved, do not set
};


void *BulletinBoard::RegisterBulletinBoardInterface()
{ 
    // This structure registers information about this class
    // that allows RapidApp to create and manipulate an instance.
    // Each entry provides a resource name that will appear in the
    // resource manager palette when an instance of this class is
    // selected, the name of the member function as a string,
    // the type of the single argument to this function, and an.
    // optional argument indicating the class that defines this function.
    // All member functions must have the form
    //  
    //     void memberFunction ( Type );
    //
    // where "Type" is one of:
    //    const char *    (Use XmRString)
    //    Boolean         (Use XmRBoolean)
    //    int             (Use XmRInt)
    //    float           (Use XmRFloat)
    //    No argument     (Use VkRNoArg or "NoArg"
    //    A filename      (Use VkRFilename or "Filename")
    //    An enumeration  (Use "Enumeration:ClassName:Type: VALUE1, VALUE2, VALUE3")
    //    A callback      (Use XmRCallback)


    static InterfaceMap map[] = {
    //---- Start editable code block: BulletinBoardUI resource table

      // { "resourceName", "setAttribute", XmRString},
    //---- End editable code block: BulletinBoardUI resource table
      { NULL }, // MUST be NULL terminated
    };

    return map;
} // End RegisterBulletinBoardInterface()






//---- End of generated code

//---- Start editable code block: End of generated code
int BulletinBoard::getNodeNames()
{
  FILE *node_stream;
  int total_nodes = 0;
  char **node_names;

  node_names = new char *[numNodes];
  
  for(int i = 0; i < numNodes; i++)
    node_names[i] = new char[27];

  /* use some UNIX stuff to read get the node names */
  if((node_stream = popen("find /hw -name node -print | sort", "r")) == NULL) {
    perror("popen()");
    return(-1);
  }
  
  /* read in the node names and figure out how many nodes there are */
  while(fgets(node_names[total_nodes], 27, node_stream) != NULL) {
    node_names[total_nodes][25] = '\0';
    total_nodes++;
  }

  pclose(node_stream);

  for(i = 0; i < total_nodes; i++)
    nodeNames[i] = XmStringCreateLocalized(node_names[i]);

  /* return total number of nodes in system */
  return(total_nodes);
}

void BulletinBoard::Update()
{
    if(currentNode == NULL)
      return;

    if (syssgi(SGI_NUMA_TUNE, MIGR_PARMS_GET, currentNode, &migr_parms) < 0) {
      showError();
    }

    switch (migr_parms.migr_as_kparms.migr_base_mode) {
    case MIGRATION_MODE_EN:
      XmToggleButtonSetState(_migrTogOn, TRUE, FALSE);
      XmToggleButtonSetState(_migrTogOff, FALSE, FALSE);
      XmToggleButtonSetState(_migrTogNormOn, FALSE, FALSE);
      XmToggleButtonSetState(_migrTogNormOff, FALSE, FALSE);
      break;
    case MIGRATION_MODE_DIS:
      XmToggleButtonSetState(_migrTogOn, FALSE, FALSE);
      XmToggleButtonSetState(_migrTogOff, TRUE, FALSE);
      XmToggleButtonSetState(_migrTogNormOn, FALSE, FALSE);
      XmToggleButtonSetState(_migrTogNormOff, FALSE, FALSE);
      break;
    case MIGRATION_MODE_ON:
      XmToggleButtonSetState(_migrTogOn, FALSE, FALSE);
      XmToggleButtonSetState(_migrTogOff, FALSE, FALSE);
      XmToggleButtonSetState(_migrTogNormOn, TRUE, FALSE);
      XmToggleButtonSetState(_migrTogNormOff, FALSE, FALSE);
      break;
    case MIGRATION_MODE_OFF:
      XmToggleButtonSetState(_migrTogOn, FALSE, FALSE);
      XmToggleButtonSetState(_migrTogOff, FALSE, FALSE);
      XmToggleButtonSetState(_migrTogNormOn, FALSE, FALSE);
      XmToggleButtonSetState(_migrTogNormOff, TRUE, FALSE);
      break;
    default:
      XmToggleButtonSetState(_migrTogOn, FALSE, FALSE);
      XmToggleButtonSetState(_migrTogOff, FALSE, FALSE);
      XmToggleButtonSetState(_migrTogNormOn, FALSE, FALSE);
      XmToggleButtonSetState(_migrTogNormOff, FALSE, FALSE);
      break;
    }
    
    switch (migr_parms.migr_as_kparms.migr_refcnt_mode) {
    case REFCNT_MODE_EN:
      XmToggleButtonSetState(_refcntTogOn, TRUE, FALSE);      
      XmToggleButtonSetState(_refcntTogOff, FALSE, FALSE);      
      XmToggleButtonSetState(_refcntTogNormOn, FALSE, FALSE);      
      XmToggleButtonSetState(_refcntTogNormOff, FALSE, FALSE);      
      break;
    case REFCNT_MODE_DIS:
      XmToggleButtonSetState(_refcntTogOn, FALSE, FALSE);      
      XmToggleButtonSetState(_refcntTogOff, TRUE, FALSE);      
      XmToggleButtonSetState(_refcntTogNormOn, FALSE, FALSE);      
      XmToggleButtonSetState(_refcntTogNormOff, FALSE, FALSE);      
      break;
    case REFCNT_MODE_ON:
      XmToggleButtonSetState(_refcntTogOn, FALSE, FALSE);      
      XmToggleButtonSetState(_refcntTogOff, FALSE, FALSE);      
      XmToggleButtonSetState(_refcntTogNormOn, TRUE, FALSE);      
      XmToggleButtonSetState(_refcntTogNormOff, FALSE, FALSE);      
      break;
    case REFCNT_MODE_OFF:
      XmToggleButtonSetState(_refcntTogOn, FALSE, FALSE);      
      XmToggleButtonSetState(_refcntTogOff, FALSE, FALSE);      
      XmToggleButtonSetState(_refcntTogNormOn, FALSE, FALSE);      
      XmToggleButtonSetState(_refcntTogNormOff, TRUE, FALSE);      
      break;
    default:
      XmToggleButtonSetState(_refcntTogOn, FALSE, FALSE);      
      XmToggleButtonSetState(_refcntTogOff, FALSE, FALSE);      
      XmToggleButtonSetState(_refcntTogNormOn, FALSE, FALSE);      
      XmToggleButtonSetState(_refcntTogNormOff, FALSE, FALSE);      
      break;
    }
    
    if(migr_parms.migr_as_kparms.migr_dampening_enabled) {
      XmToggleButtonSetState(_dampTogOn, TRUE, FALSE);
      XmToggleButtonSetState(_dampTogOff, FALSE, FALSE);
    }
    else {
      XmToggleButtonSetState(_dampTogOn, FALSE, FALSE);
      XmToggleButtonSetState(_dampTogOff, TRUE, FALSE);
    }
    
    if(migr_parms.migr_system_kparms.migr_unpegging_control_enabled) {
      XmToggleButtonSetState(_unpegTogOn, TRUE, FALSE);
      XmToggleButtonSetState(_unpegTogOff, FALSE, FALSE);
    }
    else {
      XmToggleButtonSetState(_unpegTogOn, FALSE, FALSE);
      XmToggleButtonSetState(_unpegTogOff, TRUE, FALSE);
    }

    if(migr_parms.migr_as_kparms.migr_freeze_enabled) {
      XmToggleButtonSetState(_freezeTogOn, TRUE, FALSE);
      XmToggleButtonSetState(_freezeTogOff, FALSE, FALSE);
    }
    else {
      XmToggleButtonSetState(_freezeTogOn, FALSE, FALSE);
      XmToggleButtonSetState(_freezeTogOff, TRUE, FALSE);
    }
    
    if(migr_parms.migr_as_kparms.migr_melt_enabled) {
      XmToggleButtonSetState(_meltTogOn, TRUE, FALSE);
      XmToggleButtonSetState(_meltTogOff, FALSE, FALSE);
    }
    else {
      XmToggleButtonSetState(_meltTogOn, FALSE, FALSE);
      XmToggleButtonSetState(_meltTogOff, TRUE, FALSE);
    }
    
    // Migration Threshold
    XtVaSetValues(_migrThreshScale, XmNvalue, 
		  migr_parms.migr_as_kparms.migr_base_threshold, NULL);
    XmTextFieldSetString(_migrThreshField,
			 (char *)VkFormat("%d", migr_parms.migr_as_kparms.migr_base_threshold));

    // Migration MaxAbsThreshold
    XmTextFieldSetString(_migrMAThreshField,
			 (char *)VkFormat("%d", migr_parms.migr_system_kparms.migr_threshold_reference));

    // Migration MinDistance
    XmTextFieldSetString(_migrMinDisField,
			 (char *)VkFormat("%d", migr_parms.migr_as_kparms.migr_min_distance));

    // Migration Vehicle
    _optionMenu->set(migr_parms.migr_system_kparms.migr_vehicle);

    // Refcnt UpdateAbsThreshold
    XmTextFieldSetString(_refcntUAThreshField,
			 (char *)VkFormat("%d", migr_parms.migr_system_kparms.migr_effthreshold_refcnt_overflow));

    // Dampening Factor
    XtVaSetValues(_dampFactorScale, XmNvalue, 
		  migr_parms.migr_as_kparms.migr_dampening_factor, NULL);
    XmTextFieldSetString(_dampFactorField,
			 (char *)VkFormat("%d", migr_parms.migr_as_kparms.migr_dampening_factor));

    // Dampening MemoryLowThreshold
    XtVaSetValues(_dampMLThreshScale, XmNvalue, 
		  migr_parms.migr_system_kparms.migr_memory_low_threshold, NULL);
    XmTextFieldSetString(_dampMLThreshField,
			 (char *)VkFormat("%d", migr_parms.migr_system_kparms.migr_memory_low_threshold));

    // Unpegging Threshold
    XtVaSetValues(_unpegThreshScale, XmNvalue, 
		  migr_parms.migr_system_kparms.migr_unpegging_control_threshold, NULL);
    XmTextFieldSetString(_unpegThreshField,
			 (char *)VkFormat("%d", migr_parms.migr_system_kparms.migr_unpegging_control_threshold));

    // Unpegging Interval
    XmTextFieldSetString(_unpegIntervalField,
			 (char *)VkFormat("%d", migr_parms.migr_system_kparms.migr_unpegging_control_interval));

    // Freezing Threshold
    XtVaSetValues(_freezeThreshScale, XmNvalue, 
		  migr_parms.migr_as_kparms.migr_freeze_threshold, NULL);
    XmTextFieldSetString(_freezeThreshField,
			 (char *)VkFormat("%d", migr_parms.migr_as_kparms.migr_freeze_threshold));

    // Melting Threshold
    XtVaSetValues(_meltThreshScale, XmNvalue, 
		  migr_parms.migr_as_kparms.migr_melt_threshold, NULL);
    XmTextFieldSetString(_meltThreshField,
			 (char *)VkFormat("%d", migr_parms.migr_as_kparms.migr_melt_threshold));
}

void BulletinBoard::showError()
{
  if(errno == 1)
    theErrorDialog->postBlocked("Error: Must be superuser to set values");
  else
    theErrorDialog->postBlocked("Error");
}

void BulletinBoard::generalCallback(Widget w, comp component)
{
  migr_parms_t local_mp;
  int val, i;
  char *node;

  for(i = 0; i < numPos; i++) {
    assert(XmStringGetLtoR(nodeNames[positions[i] - 1], XmFONTLIST_DEFAULT_TAG, &node));

    // Get the current set of parameters
    if (syssgi(SGI_NUMA_TUNE, MIGR_PARMS_GET, node, &local_mp) < 0) {
      showError();
    }    

    // Modify the parameters according to the value just changed
    switch(component) {
    case VEHICLE_BTE:
      local_mp.migr_system_kparms.migr_vehicle = 0;
      break;
    case VEHICLE_TLBSYNC:
      local_mp.migr_system_kparms.migr_vehicle = 1;
      break;
    case DAMP_FACTOR_FIELD:
      val = atoi(XmTextFieldGetString(w));
      if(val >= 0 && val <= 100)
	local_mp.migr_as_kparms.migr_dampening_factor = val;
      break;
    case DAMP_FACTOR_SCALE:
      XmScaleGetValue(w, &val);
      local_mp.migr_as_kparms.migr_dampening_factor = val;
      break;
    case DAMP_MLTHRESH_FIELD:
      val = atoi(XmTextFieldGetString(w));
      if(val >= 0 && val <= 100)
	local_mp.migr_system_kparms.migr_memory_low_threshold = val;
      break;
    case DAMP_MLTHRESH_SCALE:
      XmScaleGetValue(w, &val);
      local_mp.migr_system_kparms.migr_memory_low_threshold = val;
      break;
    case DAMP_SET_OFF:
      local_mp.migr_as_kparms.migr_dampening_enabled = 0;
      break;
    case DAMP_SET_ON:
      local_mp.migr_as_kparms.migr_dampening_enabled = 1;
      break;
    case FREEZE_SET_OFF:
      local_mp.migr_as_kparms.migr_freeze_enabled = 0;
      break;
    case FREEZE_SET_ON:
      local_mp.migr_as_kparms.migr_freeze_enabled = 1;
      break;
    case FREEZE_THRESH_FIELD:
      val = atoi(XmTextFieldGetString(w));
      if(val >= 0 && val <= 100)
	local_mp.migr_as_kparms.migr_freeze_threshold = val;
      break;
    case FREEZE_THRESH_SCALE:
      XmScaleGetValue(w, &val);
      local_mp.migr_as_kparms.migr_freeze_threshold = val;
      break;
    case MELT_SET_OFF:
      local_mp.migr_as_kparms.migr_melt_enabled = 0;
      break;
    case MELT_SET_ON:
      local_mp.migr_as_kparms.migr_melt_enabled = 1;
      break;
    case MELT_THRESH_FIELD:
      val = atoi(XmTextFieldGetString(w));
      if(val >= 0 && val <= 100)
	local_mp.migr_as_kparms.migr_melt_threshold = val;
      break;
    case MELT_THRESH_SCALE:
      XmScaleGetValue(w, &val);
      local_mp.migr_as_kparms.migr_melt_threshold = val;
      break;
    case MIGR_MATHRESH_FIELD:
      val = atoi(XmTextFieldGetString(w));
      if(val >= 0 && val <= 9999)
	local_mp.migr_system_kparms.migr_threshold_reference = val;
      break;
    case MIGR_MINDIS_FIELD:
      val = atoi(XmTextFieldGetString(w));
      if(val >= 0 && val <= 20)
	local_mp.migr_as_kparms.migr_min_distance = val;
      break;
    case MIGR_SET_NORMOFF:
      local_mp.migr_as_kparms.migr_base_mode = MIGRATION_MODE_OFF;
      break;
    case MIGR_SET_NORMON:
      local_mp.migr_as_kparms.migr_base_mode = MIGRATION_MODE_ON;
      break;
    case MIGR_SET_OFF:
      local_mp.migr_as_kparms.migr_base_mode = MIGRATION_MODE_DIS;
      break;
    case MIGR_SET_ON:
      local_mp.migr_as_kparms.migr_base_mode = MIGRATION_MODE_EN;
      break;
    case MIGR_THRESH_FIELD:
      val = atoi(XmTextFieldGetString(w));
      if(val >= 0 && val <= 100)
	local_mp.migr_as_kparms.migr_base_threshold = val;
      break;
    case MIGR_THRESH_SCALE:
      XmScaleGetValue(w, &val);
      local_mp.migr_as_kparms.migr_base_threshold = val;
      break;
    case REFCNT_SET_NORMOFF:
      local_mp.migr_as_kparms.migr_refcnt_mode = REFCNT_MODE_OFF;
      break;
    case REFCNT_SET_NORMON:
      local_mp.migr_as_kparms.migr_refcnt_mode = REFCNT_MODE_ON;
      break;
    case REFCNT_SET_OFF:
      local_mp.migr_as_kparms.migr_refcnt_mode = REFCNT_MODE_DIS;
      break;
    case REFCNT_SET_ON:
      local_mp.migr_as_kparms.migr_refcnt_mode = REFCNT_MODE_EN;
      break;
    case REFCNT_UATHRESH_FIELD:
      val = atoi(XmTextFieldGetString(w));
      if(val >= 0 && val <= 9999)
	local_mp.migr_system_kparms.migr_effthreshold_refcnt_overflow = val;
      break;
    case UNPEG_INTERVAL_FIELD:
      val = atoi(XmTextFieldGetString(w));
      if(val >= 0 && val <= 9999)
	local_mp.migr_system_kparms.migr_unpegging_control_interval = val;
      break;
    case UNPEG_SET_OFF:
      local_mp.migr_system_kparms.migr_unpegging_control_enabled = 0;
      break;
    case UNPEG_SET_ON:
      local_mp.migr_system_kparms.migr_unpegging_control_enabled = 1;
      break;
    case UNPEG_THRESH_FIELD:
      val = atoi(XmTextFieldGetString(w));
      if(val >= 0 && val <= 100)
	local_mp.migr_system_kparms.migr_unpegging_control_threshold = val;
      break;
    case UNPEG_THRESH_SCALE:
      XmScaleGetValue(w, &val);
      local_mp.migr_system_kparms.migr_unpegging_control_threshold = val;
      break;
    default:
      cout << "Unknown callback" << endl;
      break;
    }
    
    // Write the modified parameters back
    if (syssgi(SGI_NUMA_TUNE, MIGR_PARMS_SET, node, &local_mp) < 0) {
      showError();

      XtFree(node);
    }

    Update();
  }
}

//---- End editable code block: End of generated code


