#
#
#**************************************************************************
#*
#* 		  Copyright (c) 1992 Silicon Graphics, Inc.
#*			All Rights Reserved
#*
#*	   THIS IS UNPUBLISHED PROPRIETARY SOURCE CODE OF SGI
#*
#* The copyright notice above does not evidence any actual of intended
#* publication of such source code, and is an unpublished work by Silicon
#* Graphics, Inc. This material contains CONFIDENTIAL INFORMATION that is
#* the property of Silicon Graphics, Inc. Any use, duplication or
#* disclosure not specifically authorized by Silicon Graphics is strictly
#* prohibited.
#*
#* RESTRICTED RIGHTS LEGEND:
#*
#* Use, duplication or disclosure by the Government is subject to
#* restrictions as set forth in subdivision (c)(1)(ii) of the Rights in
#* Technical Data and Computer Software clause at DFARS 52.227-7013,
#* and/or in similar or successor clauses in the FAR, DOD or NASA FAR
#* Supplement. Unpublished - rights reserved under the Copyright Laws of
#* the United States. Contractor is SILICON GRAPHICS, INC., 2011 N.
#* Shoreline Blvd., Mountain View, CA 94039-7311
#**************************************************************************
#*
#* Makefile - lib/lpNet 	The lpNet library.
#*
#* $Revision: 1.2 $
#*
#*
#**************************************************************************

DEPTH = ../..

LPDEFS = $(DEPTH)/lpdefs

include $(LPDEFS)

LIBRARY = liblpNet.a

LCINCS = -I$(LPINC) -I$(INC)
LCOPTS = -fullwarn 

ARFLAGS = crls
LINTFLAGS = -u -z -y 
LDIRT = $(RPCGEN_TARGETS)

RPCGEN = $(TOOLROOT)/usr/bin/rpcgen
RPCFLAGS = -P

TARGETS = $(LIBRARY)

SRC = networkMgmt.c _networkMgmt.c errorMgmt.c logMgmt.c mpipes.c \
	lists.c memdup.c

XDRSRC1 = xdrMsgs.x 
XDRSRC2 = _xdrMsgs.x

XDRSRC = $(XDRSRC1) $(XDRSRC2)

# C source files generated by rpcgen
RPC_CFILES = _xdrMsgs.c xdrMsgs.c

# H header files generated by rpcgen
RPC_HFILES = $(LPINC)/_xdrMsgs.h $(LPINC)/xdrMsgs.h

CFILES = $(RPC_CFILES) $(SRC) 
RPCGEN_TARGETS = $(RPC_CFILES) $(RPC_HFILES)

default all: 
	@$(MAKE) incdepend
	@$(MAKE) $(TARGETS)

include $(COMMONRULES)

depend incdepend: $(RPCGEN_TARGETS)

$(LIBRARY): $(RPCGEN_TARGETS) $(OBJECTS)
	$(AR) $(ARFLAGS) $@ $(OBJECTS)

xdrMsgs.c:	
	$(RPCGEN) $(RPCFLAGS) -c -o $@ $(XDRSRC1)

_xdrMsgs.c:	
	$(RPCGEN) $(RPCFLAGS) -c -o $@ $(XDRSRC2)

$(LPINC)/xdrMsgs.h:	$(XDRSRC1)
	$(RPCGEN) $(RPCFLAGS) -h -o $@  $(XDRSRC1)

$(LPINC)/_xdrMsgs.h:	$(XDRSRC2)
	$(RPCGEN) $(RPCFLAGS) -h -o $@  $(XDRSRC2)

$(RPC_CFILES:.c=.o): $(RPC_CFILES)
	$(CCF) -cckr -c $<

