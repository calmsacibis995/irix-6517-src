.\" %Z%%M% %I% %E% ; TSIG - TSIX(RE) 1.1
.TH t6sendto 3N "12 Nov 1995" "TSIX(RE) 1.1"
.SH NAME
t6sendto \- Specify security attributes to send with data on a trusted endpoint
.SH SYNOPSIS
.B cc [ flags ... ] file ... 
.I -lt6
.PP
#include <sys/t6attrs.h>
.PP
.br
.nf
.ft 3
int t6sendto(int fd, const char *msg, int len, int flags,
	const struct sockaddr *to, int tolen, 
	const t6attr_t attr_ptr);
.ft P
.fi
.SH DESCRIPTION
.I t6sendto() 
allows a privileged process to specify the security
attributes to send with an 
IPC 
message.  A process may only specify
those attributes for which it possesses the appropriate override privilege 
and need not specify a full set.  Any unspecified attributes are 
supplied by the kernel.
.LP
.I fd
is a socket created with
.IR socket(3N).
The address of the target is given by
.I to
with
.I tolen
specifying its size.
The length of the message is given by
.IR len .
.LP
The 
.I to
pointer
and 
.I to_len 
parameters are only used if you are specifying the destination address, 
otherwise they should be set to 
.I 0\c
\&.  You may not specify the address if the trusted endpoint
was created for a connection oriented protocol, such as 
TCP\c
\&.
If the message is too long to pass atomically through the
underlying protocol, then the error
EMSGSIZE
is returned, and
the message is not transmitted.
.LP
A return value of 
.I \-1 
indicates locally detected errors only.
It does not implicitly mean the message was not delivered.
.LP
The
.I flags
parameter is formed
from the bitwise 
OR 
of zero
or more of the following:
.TP 20
MSG_OOB
Send \(lqout-of-band\(rq
data and any security attributes specified
by a privileged process on sockets that support this notion. 
The underlying protocol must also
support \(lqout-of-band\(rq data.
Data and 
attributes sent with this flag are typically not subject to the
internal buffering normally applied by the network to improve
network efficiency.
.TP
MSG_DONTROUTE
The
SO_DONTROUTE
option is turned on for the duration of the operation.
It is used only by diagnostic or routing programs.
.LP
The security attributes are specified by the 
.I attr_ptr 
parameter. 
To set up 
.I attr_ptr\c
, see 
.IR t6set_attr(3N)\c
\&.
.SH "RETURN VALUE"
The return value is the number of bytes actually sent, or
.I \-1 
indicating an error, with the error code stored in 
.I errno\c
\&.  
It is critical that the return value always be checked, for the 
addition of security means that access to an endpoint may be
revoked in response to a security violation.  
.SH "PRIVILEGES"
Only a process with the appropriate override privileges can specify
the security attributes associated with the data it sends.  
To specify an attribute, a process must have the override privilege 
corresponding to the attribute.
The override privilege required to specify an attribute is 
implementation specific.
.SH "ERRORS"
.LP
Errors generated by 
.I t6sendto() 
are 
indicated by the global variable
.I errno
The calls fail if:
.TP 15
[EBADF]
.B fd
is an invalid file descriptor.
.br
.ne 2
.TP
[EINTR]
The operation was interrupted by delivery of a signal before
any data could be buffered to be sent.
.TP
[EINVAL]
.I tolen
is not the size of a valid address for the specified address family.
.TP
[EMSGSIZE]
The socket requires that message be sent atomically,
and the message was too long.
.TP
[ENOMEM]
There was insufficient memory available to complete the operation.
.TP
[ENOSR]
There were insufficient
STREAMS
resources available for the operation to
complete.
.TP
[ENOTSOCK]
.I fd
is not a socket.
.SH "SEE ALSO"
libt6(3N),
t6set_attr(3N),
t6set_endpt_default(3N).
.SH SOURCE
Trusted Systems Interoperability Group
.SH NOTES
