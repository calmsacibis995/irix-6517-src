<HTML>
<HEAD>
<TITLE>Diskless Workstation Administration Guide
</TITLE></HEAD>
<BODY BGCOLOR="#F9F9F9">
<!-- dtlbook2html START -->
<HR noshade>
<FONT SIZE="-1"><A HREF="index.html"><B>Diskless Workstation Administration Guide</B></A><P><A HREF="Diskless_AG-6.html"><IMG SRC="images/b_prev.gif" ALT="Prev" WIDTH=17 HEIGHT=17 BORDER=0 ALIGN=TOP></A>&nbsp; <A HREF="Diskless_AG-8.html"><IMG SRC="images/b_next.gif" ALT="Next" WIDTH=17 HEIGHT=17 BORDER=0 ALIGN=TOP></A>&nbsp;&nbsp;&nbsp;&nbsp;Table of Contents:&nbsp;&nbsp;<A HREF="index.html">Basic</A>&nbsp;&nbsp;|&nbsp;&nbsp;<A HREF="fulltoc.html">Expanded</A></P></FONT>
<!-- dtlbook2html END -->

<A NAME=X></A><HR noshade><A NAME="SGI1"></A>
<H1 class="SGITPL-head">Chapter 4<BR> Creating Client Trees</h1><p>To install software in a client tree, you run the <i>/var/boot/client_setup</i> program to create a new client tree configuration file that specifies the requirements of your client and swap trees. To modify a client tree configuration file that already exists, you use a text editor. When the configuration file is finished, you run the client tree installation script, <i>/var/boot/client_inst</i>, to install the client and swap trees. Both the client tree configuration file and the share tree configuration file are used in the client tree installation process. After the client and swap trees are installed, clients are ready to be booted and put into service.<p>This chapter provides the information and procedures that are needed to configure and install client and swap trees. It contains these sections:<ul><li><A HREF="Diskless_AG-7.html#SGI2" TARGET=_top>"Client Tree Configuration File"</A><br><br><li><A HREF="Diskless_AG-7.html#SGI5" TARGET=_top>"Creating a New Client Tree Configuration File"</A><br><br><li><A HREF="Diskless_AG-7.html#SGI6" TARGET=_top>"Editing the Client Tree Configuration File"</A><br><br><li><A HREF="Diskless_AG-7.html#SGI7" TARGET=_top>"Verifying the Client Tree Configuration File"</A><br><br><li><A HREF="Diskless_AG-7.html#SGI8" TARGET=_top>"Installing Client and Swap Trees"</A><br><br><li><A HREF="Diskless_AG-7.html#SGI12" TARGET=_top>"Booting a Client Workstation"</A></ul><P><B>Note: </B>To update an existing client tree with a newer version of the software, use the information in <A HREF="Diskless_AG-8.html#X" TARGET=_top>Chapter 5, "Updating Software on Diskless Trees."</A><HR noshade><A NAME="SGI2"></A>
<h2 class="SGITPL-head">Client Tree Configuration File</h2><p>The client tree configuration file contains a list of variables that specify the location of the client tree, the location and size of the swap tree, and the NIS domain of the client. This file also specifies the hardware components of the client, because hardware-specific software modules must be installed in each client tree. The software installed in a client tree is obtained from the share tree that supports it.<P><B>Note: </B>Your server should already have a default copy of a client tree configuration file in <i>/var/boot/client.dat</i> as a result of installing Diskless software.<p>To create a new client tree configuration file, you can run the <i>/var/boot/client_setup</i> program, or you can create a working copy of the <i>/var/boot/client.dat</i> file that was stored on the server during the Diskless software installation process. If you plan to modify an existing client tree configuration file, you must use a text editor to make your changes.<p>Although each client in a diskless implementation must have its own client tree, it is not necessary to create an individual client tree configuration file for each client. Because the information in one configuration file frequently pertains to an entire client class, a single copy of the file can often be used to create multiple client trees. You can use the client tree configuration file for multiple client trees whenever these conditions are true:<ul><li>Clients are identical workstation models (including graphics hardware). <br><br><li>Client trees for all clients is in the same directory.<br><br><li>Swap trees for all clients is in the same directory and contain the same amount of swap space.</ul><p>For example, a single working copy of <i>client.dat</i> can be used to install the client trees for a group of Indigo R4000 Elan workstations with client trees in the <i>/diskless/client</i> directory, swap trees in the <i>/diskless/swap</i> directory, and 64 MB of swap space. <p>Client tree configuration files are stored in the <i>/var/boot</i> directory. By convention, a client tree configuration file is named for the model of clients that it configures. For example, client tree configuration files might have names like this:<p><i>/var/boot/Indigo.dat<br>/var/boot/Indigo_XS.dat<br>/var/boot/O2.dat</i><p><A HREF="Diskless_AG-7.html#SGITF1" TARGET=_top>Figure 4-1</A> illustrates two client configuration files that are used to create client trees for seven clients.<p><p> <A NAME="SGITF1"></A><IMG SRC="images/Fig4-1.gif" WIDTH=188 HEIGHT=343 ALT="Fig4-1.gif" BORDER=0 ALIGN=absmiddle><p><B>Figure 4-1 :  </B>Multiple Client Trees From One Configuration File<p><br><A NAME="SGI3"></A>
<h3 class="SGITPL-head">Client and Swap Tree Variables</h3><p>The variables in the upper portion of the client configuration file specify the location of the client tree and swap tree, the size of the swap space, and the NIS domain name for clients using this file.<p>Example 4-1     illustrates the upper portion of the <i>client.dat</i> file.<p><B>Example 4-1 : </B>Client Tree Setup Section of client.dat <pre></pre><PRE># Information for diskless client setup.
# Please make a copy of this file for each class of diskless machines.
#
# $Revision: 1.1 $
#
#
#      DISKLESS CLIENT TREE SPECIFICATIONS
#
#      CLROOT :    directory where client tree resides.
#      SWAP :      directory where swap file resides.
#      SWAPSIZE :  size of swap file.
#                  Same format as "mkfile" takes.
#      NISDOMAIN : If set to any value, then NIS domain is set
#                  as specified. If set to null, then client's
#                  NIS domain is set as diskless server's NIS domain
#                  unless client's NIS domain is set previously.
#
#      NOTE:
#             If one wants to prevent the client from using
#             swap space on server, then set SWAPSIZE="0".
#             However, If one still wants to preserve already
#             existing swap space on server for some reason,
#             then set SWAP="".
#
CLROOT="$DISKLESS/client/$HOST" 
SWAP="$DISKLESS/swap/$HOST" 
SWAPSIZE="64m"
NISDOMAIN=" "</PRE><p>The variables in this portion of <i>client.dat</i> have these meanings:<dl><dt><var>CLROOT</var><dd><br>Specifies the pathname of the client tree (see <A HREF="Diskless_AG-5.html#SGITF3" TARGET=_top>Figure 2-1</A>). The default value is $<var>DISKLESS/client/$HOST</var>. <dd><br>Reset this value if you plan to install your client trees in a directory other than the one specified by the<var> $DISKLESS</var> variable (in the share tree configuration file); be sure your entry ends in the string <var>$HOST</var>. The value of <var>$HOST</var> is the hostname of the client that you enter on the <i>client_inst</i> command line to install the client tree.<dt><br><var>SWAP</var><dd><br>Specifies the pathname of the swap tree (see <A HREF="Diskless_AG-5.html#SGITF3" TARGET=_top>Figure 2-1</A>). The default value is <i>$DISKLESS/swap/$HOST</i>.<dd><br>Reset this value if you plan to install your swap trees in a directory other than the one specified by the<var> $DISKLESS</var> variable (in the share tree configuration file); be sure your entry ends in the string <var>$HOST</var>. The value of <var>$HOST</var> is the  hostname of the client that you enter on the <i>client_inst</i> command line to install the swap tree.<dt><br><var>SWAPSIZE</var> <dd><br>Specifies the size of the swap space, in megabytes. The default value is 64 megabytes. If you change this value, your entry must end with the letter <i>m</i> (lowercase), the only allowable value for megabytes.<dt><br><var>NISDOMAIN</var><dd><br>Specifies the domain name for a client. The default setting is null ( " "), which assigns the server's domain name to its clients. This setting can vary for individual clients in a class. <dd><br>Set <var>NISDOMAIN</var> to null (" ") to assign the server's domain name to the client. The <i>client_inst</i> script will enter the server's domain name in the client's copy of <i>/var/yp/ypdomain</i>. <dd><br>Set <var>NISDOMAIN</var> to an alternative domain name if clients are using a domain name that is different from the server's. The <i>client_inst</i> script will enter the domain name you specify in the client's copy of <i>/var/yp/ypdomain</i>. <P><B>Note: </B>You will need to set <i>yp</i> to <var>on</var> with chkconfig on the client so that the client can participate in NIS. </dl><A NAME="SGI4"></A>
<h3 class="SGITPL-head">Client Hardware Variables</h3><p>The variables in the lower portion of <i>client.dat</i> specify the hardware components of client workstations. Example 4-2     illustrates the table in the lower portion of <i>client.dat</i>.<p><B>Example 4-2 : </B>Architecture Tables in client.dat<pre></pre><PRE># Client CPUARCH/CPUBOARD/GFXBOARD/MODE values for releases 5.1 and
# beyond. CPUARCH should be omitted for releases prior to 4.0.4, but will
# not hurt if present (as long as the server is at 4.0.4 or later)
#
# NOTES    NOTES    NOTES    NOTES    NOTES
#
# 1. For CPUARCH values which are derivatives of the R4000 architecture,
#        like R4400, just use R4000 as the CPUARCH value.
# 
# 2.  CPUARCH should be set to the values shown below.
# 
# 3. If you modify the supported or unsupported architectures below, please
#        change the file d1_classes.
# 
# 4. The MACH variable is no longer applicable to current releases.
# 
# 5. The MODE pad should be set on Indigo2 R10000, O2, & OCTANE.
#
#+-------------------+---------+----------+------------------------------------+
#| Machine Type      | CPUARCH | CPUBOARD | GFXBOARD                  | VIDEO  |
#|                   |         | /MACH    |                           |        |
#+-------------------+---------+----------+---------------------------+--------|
#| Indigo R4K        | R4000   |   IP20   | "LIGHT   -mSUBGR=LG1MC"   |        |
#| Indigo R4K DH     | R4000   |   IP20   | "LIGHT   -mSUBGR=LG1MC"   |        |
#| Indigo R4K XS     | R4000   |   IP20   | "EXPRESS -mSUBGR=EXPRESS" |        |
#| Indigo R4K XZ     | R4000   |   IP20   | "EXPRESS -mSUBGR=EXPRESS" |        |
#| Indigo R4K Elan   | R4000   |   IP20   | "EXPRESS -mSUBGR=EXPRESS" |        |
#|  Note: Indigo is also known as 4D/RPC. |                           |        |
#|                   |         |          |                           |        |
#| Indigo2 Extreme   | R4000   |   IP22   | "EXPRESS -mSUBGR=EXPRESS" |        |
#| Indigo2 XZ        | R4000   |   IP22   | "EXPRESS -mSUBGR=EXPRESS" |        |
#| Indigo2 Extreme+XL| R4000   |   IP22   |"NEWPRESS -mSUBGR=NEWPRESS"|        |
#| Indigo2 XL        | R4000   |   IP22   |"NEWPORT -mSUBGR=NG1"      |        |
#| Indigo2 IMPACT    | R4000   |   IP22   | "MGRAS   -mSUBGR=MGRAS"   |        |
#|   Notes: (1) Extreme+XL indicates dual heads: one Extreme, one XL.          |
#|  (2) The galileo board is only a graphics option.  It does not change       |
#|      the architecture of a diskless client.                                 |
#
#| Indy              | R4000   |   IP22   | "NEWPORT -mSUBGR=NG1"     | VINO   |
#| Indy R5000        | R5000   |   IP22   | "NEWPORT -mSUBGR=NEWTON"  | VINO   |
#|   Note: VIDEO tag is only used by Indy for now.                    |        |
#|                   |         |          |                           |        |
#| Indigo2 10000     |         |          |                           |        |
#|         IMPACT    | R10000  |   IP28   | "MGRAS -mSUBGR=I2_64"     |        |
#|         Extreme   | R10000  |   IP28   | "EXPRESS -mSUBGR=I2_64"   |        |
#|         XZ        | R10000  |   IP28   | "EXPRESS -mSUBGR=I2_64"   |        |
#| NOTE: MODE="64bit"|         |          |                           |        |
#|                   |         |          |                           |        |
#| OCTANE            |         |          |                           |        |
#|         SI/SSI/MXI| R10000  |   IP30   | "MGRAS -mSUBGR=RACER"     |        |
#| NOTE: MODE="64bit"|         |          |                           |        |
#|                   |         |          |                           |        |
#| O2                | R5000   |   IP32   | "CRIME -mSUBGR=CRM"       | VICE   |
#|                   | R10000  |   IP32   | "CRIME -mSUBGR=CRM"       | VICE   |
#| NOTE: MODE="32bit"|         |          |                           |        |
#|                   |         |          |                           |        |
#+--------------------+---------+----------+---------------------------+-------+
#
# The following machines are NOT supported for diskless operation in the
# current release.  The last column states the version of IRIX which last
# supported a specific architecture.  NEVER means a specific architecture
# was never supported in a diskless configuration.
#
#+--------------------+---------+----------+---------------------------+-------+
#| Machine Type       | CPUARCH | CPUBOARD |          GFXBOARD         |VERSION|
#+--------------------+---------+----------+---------------------------+-------+
#| 4D/50G             | R3000   |   IP4    | "CLOVER1"                 | NEVER  |
#| 4D/50GT            | R3000   |   IP4    | "CLOVER2 -mSUBGR=IP4GT"   | NEVER  |
#| 4D/70G             | R3000   |   IP4    | "CLOVER1"                 | NEVER  |
#| 4D/70GT            | R3000   |   IP4    | "CLOVER2 -mSUBGR=IP4GT"   | NEVER  |
#|                    |         |          |                           |        |
#| 4D/120GTX          | R3000   |   IP5    | "CLOVER2 -mSUBGR=IP5GT"   | NEVER  |
#|                    |         |          |                           |        |
#| 4D/xy0GTX          | R3000   | IP{5,7,9}| "CLOVER2 -mSUBGR=IP7GT"   | NEVER  |
#| 4D/xy0RE           | R3000   | IP{5,7,9}| "VENICE  -mSUBGR=IP7"     | NEVER  |
#| 4D/xy0SKY          | R3000   | IP{5,7,9}| "STAPUFT -mSUBGR=SKYWR"   | NEVER  |
#| 4D/xy0VGX          | R3000   | IP{5,7,9}| "STAPUFT -mSUBGR=IP7GT"   | NEVER  |
#|  where x=2, 3 or 4, and y=1, 2, 4, or 8.                            |        |
#|                    |         |          |                           |        |
#| 4D/20{G,TG}        | R3000   |   IP6    | "ECLIPSE -mSUBGR=ECLIPSE" |  5.3   |
#| 4D/25{G,TG}        | R3000   |   IP6    | "ECLIPSE -mSUBGR=ECLIPSE" |  5.3   |
#| Key:  4D/20{G,TG} is an abbreviation for 4D/20, 4D/20G, and 4D/20TG.|        |
#|                    |         |          |                           |        |
#| 4D/210GTX
#| 4D/30{G,TG}        | R3000   |   IP12   | "ECLIPSE -mSUBGR=ECLIPSE" |  5.3   |
#| 4D/30EG (Elan)     | R3000   |   IP12   | "EXPRESS -mSUBGR=EXPRESS" |  5.3   |
#| 4D/30XS{24}        | R3000   |   IP12   | "EXPRESS -mSUBGR=EXPRESS" |  5.3   |
#| 4D/35XS{24}        | R3000   |   IP12   | "EXPRESS -mSUBGR=EXPRESS" |  5.3   |
#|                    |         |          |                           |        |
#| 4D/35{G,TG}        | R3000   |   IP12   | "ECLIPSE -mSUBGR=ECLIPSE" |  5.3   |
#| 4D/35EG (Elan)     | R3000   |   IP12   | "EXPRESS -mSUBGR=EXPRESS" |  5.3   |
#|                    |         |          |                           |        |
#| Indigo             | R3000   |   IP12   | "LIGHT   -mSUBGR=LIGHT"   |  5.3   |
#| Indigo Dual Head   | R3000   |   IP12   | "LIGHT   -mSUBGR=LIGHT"   |  5.3   |
#| Indigo XS{24}      | R3000   |   IP12   | "EXPRESS -mSUBGR=EXPRESS" |  5.3   |
#| 4D/35EG (Elan)     | R3000   |   IP12   | "EXPRESS -mSUBGR=EXPRESS" |  5.3   |
#|                    |         |          |                           |        |
#| Indigo             | R3000   |   IP12   | "LIGHT   -mSUBGR=LIGHT"   |  5.3   |
#| Indigo Dual Head   | R3000   |   IP12   | "LIGHT   -mSUBGR=LIGHT"   |  5.3   |
#| Indigo XS{24}      | R3000   |   IP12   | "EXPRESS -mSUBGR=EXPRESS" |  5.3   |
#| Indigo Elan        | R3000   |   IP12   | "EXPRESS -mSUBGR=EXPRESS" |  5.3   |
#|                    |         |          |                           |        |
#| Crimson BLG        | R4000   |   IP17   | "LIGHT   -mSUBGR=IP17"    | NEVER  |
#| Crimson XS{24}     | R4000   |   IP17   | "EXPRESS -mSUBGR=IP17"    | NEVER  |
#| Crimson Elan       | R4000   |   IP17   | "EXPRESS -mSUBGR=IP17"    | NEVER  |
#| Crimson GTX        | R4000   |   IP17   | "CLOVER2 -mSUBGR=IP17"    | NEVER  |
#| Crimson VGX        | R4000   |   IP17   | "STAPUFT -mSUBGR=IP17"    | NEVER  |
#| Crimson VGXT       | R4000   |   IP17   | "STAPUFT -mSUBGR=IP17SKY" | NEVER  |
#| Crimson RE         | R4000   |   IP17   | "VENICE  -mSUBGR=IP17"    | NEVER  |
#|                    |         |          |                           |        |
#| Onyx               |         |          |                           |        |
#|    Extreme         | R4000   |   IP19   | "EXPRESS -mSUBGR=IP19"    | NEVER  |
#|    Extreme         | R10000  |   IP25   | "EXPRESS -mSUBGR=IP25"    | NEVER  |
#|    RealityEngine2  | R4000   |   IP19   | "VENICE  -mSUBGR=IP19"    | NEVER  |
#|    RealityEngine2  | R10000  |   IP25   | "VENICE  -mSUBGR=IP25"    | NEVER  |
#|    InfiniteReality | R4000   |   IP19   | "KONA    -mSUBGR=IP19"    | NEVER  |
#|    InfiniteReality | R10000  |   IP25   | "KONA    -mSUBGR=IP25"    | NEVER  |
#|                    |         |          |                           |        |
#| PowerOnyx          |         |          |                           |        |
#|    Extreme         | R8000   |   IP21   | "EXPRESS -mSUBGR=IP21"    | NEVER  |
#|    RealityEngine2  | R8000   |   IP21   | "VENICE  -mSUBGR=IP21"    | NEVER  |
#|    InfiniteReality | R8000   |   IP21   | "KONA    -mSUBGR=IP21"    | NEVER  |
#|                    |         |          |                           |        |
#| Power Indigo2      |         |          |                           |        |
#|         Extreme    | R8000   |   IP26   | "EXPRESS -mSUBGR=I2_64"   | 6.0.1  |
#|         XZ         | R8000   |   IP26   | "EXPRESS -mSUBGR=I2_64"   | 6.0.1  |
#+--------------------+---------+----------+---------------------------+--------+
#
CPUBOARD="IP20"
CPUARCH=R4000
MACH="IP20"
GFXBOARD="LIGHT -mSUBGR=LG1MC"
VIDEO=" "</PRE><p>The variables in the hardware specification section of <i>client.dat</i> have these meanings:<dl><dt><var>CPUAR</var>CH<dd><br>Specifies the type of CPU architecture in a client workstation. The default value for <var>CPUARCH</var> is <var>R4000</var>.<dd><br>Set <i>CPUARCH</i> to the value for the workstation model using this client tree. <var>CPUARCH</var> must be assigned only one value in <i>client.dat</i>. See Example 4-2     or the tables in <i>client.dat</i> for valid entries. <dt><br>CPUBOARD<dd><br>Specifies the CPU subsystem in a client workstation. The default value for <var>CPUBOARD</var> is <var>IP20</var>.<dd><br>Set <i>CPUBOARD</i> to the workstation model using this client tree. <var>CPUBOARD</var> must be assigned only one value in <i>client.dat</i>. See Example 4-2     or the tables in <i>client.dat</i> for valid entries. <dt><br><var>GFXBOARD</var><dd><br>Specifies the type of graphics subsystem in a client workstation. A subgroup designation is also required in this setting. The default value for <var>GFXBOARD</var> is <var>LIGHT</var>, whose subgroup is <var>LG1MC</var>.<dd><br>Set <i>GFXBOARD</i> to the value for the workstation model using this client tree. <var>GFXBOARD</var> and its subgroup must be assigned only one value in <i>client.dat</i>. See Example 4-2     or the tables in <i>client.dat</i> for valid entries. <dt><br><var>VIDEO</var><dd><br>Specifies the video chip for Indy (VINO) and O2 (VICE) workstations. The default setting is null, which indicates systems with no on-board video hardware.<dd><br>Set <var>VIDEO</var> to <var>VINO</var> for Indy workstations; set it to <var>VICE</var> for O2 workstations. For other models, use the default setting (null).<dt><br><var>MODE</var><dd><br><var></var>Specifies the 32-bit or 64-bit version of the operating system.</dl><HR noshade><A NAME="SGI5"></A>
<h2 class="SGITPL-head">Creating a New Client Tree Configuration File</h2><p>Use the <i>client_setup</i> setup program to create a client tree configuration file for an individual client or class of clients in your diskless implementation (see <A HREF="Diskless_AG-7.html#SGI2" TARGET=_top>"Client Tree Configuration File"</A>).<P><B>Note: </B>If you prefer to use an editor to create this file, or if you need to modify an existing client tree configuration file, use the information in <A HREF="Diskless_AG-7.html#SGI6" TARGET=_top>"Editing the Client Tree Configuration File"</A> instead of this procedure.<p>This procedure explains how to create a new client tree configuration file using <i>client_setup</i>.<ol><li>Start <i>client_setup</i>.<PRE># <B>cd /var/boot</B>
# <B>./client_setup</B></PRE><p>After your entry, this prompt is displayed:<PRE>This program will help you create a client tree configuration<br>file for the client you would like to install.

Choose the CPU board:
       1. IP20
       2. IP22
       3. IP28
       4. IP30
       5. IP32
Choose one (1 2 3 4 5):</PRE><li> Enter the number of  your selection.<p>After your entry, your selection is confirmed and another prompt is displayed:<PRE>&gt;&gt; IP28 selected.
  Choose the graphics board:
       1. LIGHT
       2. EXPRESS
Choose one (1 2):</PRE><li> Enter the number of your selection.<p>After your entry, your selection is confirmed and another prompt is displayed:<PRE>&gt;&gt;LIGHT selected.
You have defined a client class with these components:
        CPUBOARD=IP20
        CPUARCH=R4000
        GFXBOARD=LIGHT -mSUBGR=LG1MC
        VIDEO=
        MODE=32bit
Specify a size in MB for swap.
Swap size (Default is 64m - &lt;Enter&gt; for default):</PRE><li>Specify the size of your swap file.<p>If you wish to specify a swap file that is different from the default, enter the size (the unit of measure is megabytes).  Or, press <TT><B>Enter</B></TT> to set the swap size to 64 megabytes.<p>After your entry, this prompt is displayed:<PRE>Enter your NIS domain name (hit &lt;Enter&gt; for no domain name):</PRE><li>Specify a domain or simply press <TT><B>Enter</B></TT>.<p>If the clients supported by this file are using an NIS domain name that is different from the server's, enter the domain name for the clients.  Otherwise, press <TT><B>Enter</B></TT> to set the client domain name to the domain name of the server.<p>After your entry, this prompt is displayed:<PRE>Specify a name for your client tree configuration file<br>(no extension please):</PRE><li>Specify a name for this client tree configuration file.<p>See <A HREF="Diskless_AG-7.html#SGI2" TARGET=_top>"Client Tree Configuration File"</A> for naming conventions.<br><br><li>Verify that your client tree configuration file executes.<p>See the information in <A HREF="Diskless_AG-7.html#SGI7" TARGET=_top>"Verifying the Client Tree Configuration File"</A> for this step.</ol><HR noshade><A NAME="SGI6"></A>
<h2 class="SGITPL-head">Editing the Client Tree Configuration File</h2><p>To modify an existing client tree configuration file, use a text editor to make your changes. You can also use a text editor instead of <i>client_setup</i> to create a new client tree configuration file.<p>When you install Diskless software on a server, a default version of the configuration file is stored at <i>/var/boot/client.dat</i>. If you are creating a new configuration file with a text editor, use a working copy of <i>client.dat</i> as the source for the new file. (Do not edit the original version of <i>client.dat</i>; make a copy of it and make your changes to the copy.) You will need to change several values in the default version of <i>client.dat</i>.<p>Refer to these sections for information on setting variables when you edit a working copy of<i> client.dat</i>:<ul><li><A HREF="Diskless_AG-7.html#SGI3" TARGET=_top>"Client and Swap Tree Variables"</A><br><br><li><A HREF="Diskless_AG-7.html#SGI4" TARGET=_top>"Client Hardware Variables"</A></ul><HR noshade><A NAME="SGI7"></A>
<h2 class="SGITPL-head">Verifying the Client Tree Configuration File</h2><p>The <i>client.dat</i> file and its working copies are executable shell scripts. After you create a new client tree configuration file or edit an existing one, check its syntax by executing it, as shown in this example: <pre># <B>sh Indigo_XS.dat</B></pre><p>If a prompt is returned after your entry, then the syntax in your configuration file is correct. If you receive any other response, the execution was not successful. Check your entries in the working file and correct any syntax errors. Then, execute the working file again.<P><B>Note: </B>This command does not check the validity of your settings in <i>client.dat</i>; it checks only the file syntax.<HR noshade><A NAME="SGI8"></A>
<h2 class="SGITPL-head">Installing Client and Swap Trees </h2><p>To install a client tree, run <i>client_inst</i>, which reads the working copy of the client and share tree configuration files for configuration information; then <i>client_inst</i> calls <i>inst</i> to install the software. Because the share tree serves as the software source, you must have installed the share tree before installing any of the client trees that will use it. After you create one client tree, you can use the <i>client_clone</i> program to create additional copies of the tree (see <A HREF="Diskless_AG-7.html#SGI11" TARGET=_top>"Cloning Client Trees"</A>). Individual client trees are stored in <i>/diskless/client_root/client_name</i>. <P><B>Note: </B>You must install the <i>nfs.sw.dskless_client</i> subsystem in every client tree.<p>As part of the client tree installation process, <i>client_inst</i> installs the swap tree for each client in <i>/diskless/swap/client_name</i>. It also creates the <i>/etc/fstab</i> and <i>/etc/hosts</i> files that clients need and includes them in the client trees. Finally, <i>client_ins</i>t adds entries that clients need in the server's <i>/etc/exports</i> file and <i>/etc/bootparams</i> file (or that of the NIS master server). The internet address for a client must be available to network software when you install its client tree (see <A HREF="Diskless_AG-5.html#SGI5" TARGET=_top>"Assigning Internet Addresses" in Chapter 2</A> for details).<A NAME="SGI9"></A>
<h3 class="SGITPL-head">The client_inst Command</h3><p>The <i>client_inst</i> command initiates client and swap tree installations. This command requires arguments that identify the hostname of the client being installed and the share tree and client tree configuration files to be used in the installation. <p>Syntax for the <i>client_inst</i> command is shown below (see the man page client_inst for a more complete description). <pre>client_inst -h<var> hostname</var> -r<var> release</var> -c<var> class</var> [-d]</pre><p>Arguments to <i>client_inst</i> have these meanings:<dl><dt>-h <var>hostname</var><dd><br>Specifies the hostname of an individual client whose tree you are installing. <dt><br>-r <var>release</var><dd><br>Specifies the share tree configuration file (without the <i>.dat</i> extension) that  is used during client tree installations.<dt><br>-c<var> class</var><dd><br>Specifies the working copy of <i>cl</i><i>ient.dat</i> for this class (without the <i>.dat</i> extension). <dt><br>-d<dd><br>Deletes a client tree. </dl><p>The following sample illustrate <i>client_inst</i> command entries. <PRE>client_inst -h starlite -r IRIX_65-32 -c O2</PRE><p>The entry in this sample installs a client tree and swap tree for a client named <i>starlite</i> using a share tree configuration file called <i>IRIX_ 65-32 </i>(the <i>.dat</i> extension is omitted) and a client tree configuration file named <i>O2</i> (the <i>.dat</i> extension is omitted). <A NAME="SGI10"></A>
<h3 class="SGITPL-head">Client and Swap Tree Installation Procedure</h3><p>The procedure in this section explains how to use <i>client_inst</i> to launch a client tree installation that creates a client and swap tree. Remember, only software that is installed on the share tree can be installed in a client tree.<p>When running <i>client_inst</i>, use the same media in the same order that you used with <i>share_inst</i>, that is, the operating system CD first, then the NFS CD, and any other source media.<p>The procedure assumes that you are using Inst, the command-line interface to the installation program, but you can use Software Manager, the graphical interface, instead. (See <i></i>IRIX Admin: Software Installation and Licensing    <i></i>for information on using Inst; see the <i></i>Personal System Administration Guide    <i></i>for information on using Software Manager.) After a client tree is created, you can add new clients by cloning the tree (see <A HREF="Diskless_AG-7.html#SGI11" TARGET=_top>"Cloning Client Trees"</A>).<P><B>Note: </B>If you are updating an existing client tree, do not use the procedures that follows. Use the update procedures in <A HREF="Diskless_AG-8.html#X" TARGET=_top>Chapter 5</A> instead.<ol><li>Shut down the client system.<br><br><li>From the <i>/var/boot</i> directory, start <i>client_inst,</i> use the same media in the same order that you used with <i>share_inst</i>, that is, the operating system CD first, then the NFS CD, and any other source media.<PRE><B># ./client_inst -h starlite -r  IRIX_65-32 -c O2</B></PRE><p>This example directs <i>client_inst</i> to create a client tree for <i>starlite </i>using configuration information in <i>IRIX_65-32.dat</i> for its share tree and <i>O2.dat</i> for its client tree. A swap tree is automatically created for this client.<p>After processing this entry, <i>client_inst</i> displays this prompt: <PRE>Client tree = /diskless/client/starlite,
                     shared tree = /diskless/share/IRIX_65-32 
Enter confirmation (y/Y):
Create 64m swap file ........</PRE><P><B>Note: </B>The pathname of the client and share trees in this prompt should match the pathnames that appear in this prompt.<br><br><li>Enter <TT><B>y</B></TT> or <TT><B>Y</B></TT> (yes) to confirm the start of installation. <p>After your entry, the Inst main menu is displayed: <PRE>Default location of new software is &lt;<var>previous installation location</var>&gt;
If you are a first-time inst user, give the command "help beginner".
Inst Main Menu
 1. from [source...]          Specify location of software to be installed
 2. open [source...]          Specify additional software locations
 3. close [source]            Close distributions
 4. list [keywords][names]    Display information about software subsystems
 5. go                        Perform software installation and removal now
 6. install [keywords][names] Select subsystems to be installed
 7. remove [keywords][names]  Select subsystems to be removed
 8. keep [keywords][names]    Do not install or remove these subsystems
 9. step [keywords][names]    Enter interactive mode for install/remove/keep
10. conflicts [choice...]     List or resolve installation conflicts 
11. help [topic]              Get help in general or on a specific word
12. view ...                  Go to the View Commands Window
13. admin                     Go to the Administrative Commands Menu
14. quit                      Terminate software installation<br>Inst&gt; </PRE><br><br><li>Enter <TT><B>list</B></TT> to check to check the software selected for installation (optional). <p>The <i>list</i> option displays the contents of the share tree; the subsystems selected for installation (automatically chosen by <i>inst</i>) are marked by the letter <i>i</i>.<p>The <i>list</i> option also calculates the disk space needed to install the default selections and displays the amount of disk space that is available for installation. When the calculations are complete, check the disk space summary to determine the amount of disk space the client tree will require.<br><br><li>Install the <i>nfs.sw.dskless_client</i> subsystem.<p>This subsystem is required for diskless operation.<pre>Inst&gt; <B>install nfs.sw.dskless_client</B></pre><li>Change the default selections if necessary. <p>If you want to change the default selections, use the <i>step i</i> option to advance through the list of selected subsystems on the source. Use one of these entries for each subsystem that the <i>step</i> option posts: <br><br><dl><TT><B>Enter</B></TT><dd><br>To leave the selection unchanged. <TT><B>r Enter</B></TT><dd><br>If it is marked <i>i</i> and you do not want it installed <TT><B>i Enter</B></TT><dd><br>If it is not marked <i>i</i> and you want to install it. </dl><br><li>Enter <TT><B>go</B></TT> to launch the installation: <p>The <i>go</i> option installs all software subsystems marked for installation. <p>As it works, <i>inst</i> reports status messages and identifies subsystems that it is installing: <PRE>Installing new versions of selected <var>subsystem</var>.</PRE><p>When it finishes, <i>inst</i> displays this message: <PRE>Installation and/or removal succeeded.</PRE><li>Enter <TT><B>quit</B></TT> to finish the installation: <p>After your entry, <i>inst</i> processes a suite of <i>exit</i> commands. Allow the <i>exit</i> commands several minutes to process. During exit processing, watch for a "building kernel" message.<P><B>Caution: </B>Do not make any entries that will interrupt processing of the <i>exit</i> commands (such as Ctrl+C, for example). Doing so can result in damage to your system. </ol><p>When processing is complete, one client tree is installed on the server system. You can repeat this procedure for other clients, or use the <i>clone_client</i> command to reproduce additional client trees automatically (see <A HREF="Diskless_AG-7.html#SGI11" TARGET=_top>"Cloning Client Trees"</A>). <A NAME="SGI11"></A>
<h3 class="SGITPL-head">Cloning Client Trees </h3><p>Client trees can be reproduced using the <i>clone_client</i> program. Like the conventional <i>client_inst</i> process, <i>clone_client</i> automatically creates a swap tree when it creates a client tree. When you use<i> clone_client</i>, you can create a duplicate client tree from another client tree or from the share tree. The software installed in cloned trees is obtained from the same source as the software used to install the model client or share tree originally. For example, if the software in the model client tree /<i>diskless/client/starlite</i> was installed from the remote distribution directory <i>sandy:/dist/IRIX65-32</i>, then the software in any tree cloned from the starlite tree is obtained from that directory on sandy.<p>The <i>clone_client</i> command has this syntax: <pre>client_inst <b>-f</b> <var>filename </var><b>-r</b> <var>release</var> <b>-c</b> <var>class</var> <b>-clone</b> <var>src_root</var></pre><p>Specify this information in command arguments:<dl><dt>-f <var>filename</var><dd><br>A file containing the names of hosts whose trees are being created by the cloning process. <dt><br>-r <var>release</var><dd><br>The working copy of the share tree configuration file that defines this client's share tree (without the <i>.dat</i> extension). <dt><br>-c <var>class</var><dd><br>Is the name of the working copy of client tree configuration file that was used for the model client tree (without the <i>.dat</i> extension).<dt><br>-clone <var>src_root</var><dd><br>The complete pathname to the source of the software to be included in client tree. The source can be a share tree or another client tree. You must specify the complete pathname of the source. For example, if starlite's client tree is used as the model, this argument will read <var>-clone /diskless/client/starlite</var>. </dl><HR noshade><A NAME="SGI12"></A>
<h2 class="SGITPL-head">Booting a Client Workstation</h2><p>Once you finish building a client tree, diskless software is ready to support clients. The procedure that follows explains how to prepare a client workstation, then boot it to run as a diskless system. <P><B>Note: </B>Be sure that bootparams is enabled in the server's <i>/etc/inetd.conf</i> file before you begin this procedure (see step 9 of <A HREF="Diskless_AG-5.html#SGI3" TARGET=_top>"Checking a Server"</A>).<p>Go to the client workstation to do this procedure:<ol><li>Shut down the client, if it is running. <p>If the client is running, type <TT><B>shutdown</B></TT> on the console to bring down the system. If you do not shut down the client, a message warns you that the client might crash.<br><br><li>Go to the Command Monitor. <p>This step is different for different workstation models. See the owner's guide for this model if you need instructions. <br><br><li>Check the NVRAM variables. <p>Enter <TT><B>printenv</B></TT> and check its output for NVRAM variables. It should have several lines of these variables. <br><br><li>Set the NVRAM variables that support diskless operation. <p>The sample commands that follow illustrate how to set NVRAM variables. Notice that Indigo R4000 workstations require two variables to specify the boot file setting: <PRE>&gt;&gt;setenv diskless 1
&gt;&gt;setenv netaddr 192.0.2.6 
&gt;&gt;setenv bootfile bootp()sandy:/var/boot/starlite/unix 
&gt;&gt;setenv SystemPartition bootp()sandy:/var/boot/starlite
&gt;&gt;setenv OSLoadPartition bootp()sandy:/var/boot/starlite
&gt;&gt;setenv OSLoader /unix </PRE><p>The variables in these examples have the following meaning: <br><br><dl><var>diskless</var><dd><br>The variable that enables diskless service. Set <var>diskless</var> to 1.<var>netaddr</var><dd><br>The client's Internet address. See <A HREF="Diskless_AG-5.html#SGI5" TARGET=_top>"Assigning Internet Addresses" in Chapter 2</A> if you need help with this setting. <var>bootfile</var><dd><br>The complete pathname for the client's boot file. In the sample command above, <i>/var/boot/starlite/unix</i> on server sandy will be used to boot client starlite.<var>SystemPartition</var><dd><br>The directory where the operating system loader is located. In the previous sample command, the directory <i>/var/boot/starlite</i> on server <var>sandy</var> contains the operating system loader for starlite. OSLoadPartition<dd><br> The directory where the core operating system is located. In the previous sample command, the directory <i>/var/boot/starlite</i> on server <var>sandy</var> contains the boot file for starlite.<var>OSLoader</var><dd><br>is the name of the IRIX boot file. The previous sample command specifies the boot file to be <i>/unix</i>.</dl><br><li>Enter <TT><B>printenv</B></TT> to verify your entries. <p>Check the values of the NVRAM variables in the output from <i>printenv</i> to verify that the settings are correct. <br><br><li>Enter <TT><B>init</B></TT> to set NVRAM variables. <p>If your system's Ethernet transceiver has light emitting diodes (LED), you will see Ethernet activity for about 3 to 10 minutes, depending on other Ethernet activity. After a few minutes, the Command Monitor menu is displayed. <br><br><li>To start the client, select <TT>1) Start System</TT> from the Command Monitor. <br><br><li>Configure the client as you would normally configure any host.<p>For many networks, host configuration commonly includes such tasks as setting a netmask, mounting (or automounting) filesystems, and setting up user accounts. Perform such tasks on the diskless clients that you are running.<br><br><li>Reboot each client to put them into operation.</ol><p>Once booting is complete, the client workstation is running as a diskless workstation. Step 4 of this procedure should be repeated if any environment variables change (if the client gets a new Internet address, for example). 
      

<!-- dtlbook2html START -->
<HR noshade>
<FONT SIZE="-1"><A HREF="index.html"><B>Diskless Workstation Administration Guide</B></A><P><A HREF="Diskless_AG-6.html"><IMG SRC="images/b_prev.gif" ALT="Prev" WIDTH=17 HEIGHT=17 BORDER=0 ALIGN=TOP></A>&nbsp; <A HREF="Diskless_AG-8.html"><IMG SRC="images/b_next.gif" ALT="Next" WIDTH=17 HEIGHT=17 BORDER=0 ALIGN=TOP></A>&nbsp;&nbsp;&nbsp;&nbsp;Table of Contents:&nbsp;&nbsp;<A HREF="index.html">Basic</A>&nbsp;&nbsp;|&nbsp;&nbsp;<A HREF="fulltoc.html">Expanded</A></P></FONT>
<!-- dtlbook2html END -->

<HR noshade>
</BODY>
</HTML>
