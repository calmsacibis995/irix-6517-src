<!-- Produced by version 3.14 (11/22/96) of SGI Frame/SGML translator -->
<CHAPTER LBL="4"><TITLE><XREFTARGET ID="70096">Networking With Trusted IRIX/CMW</TITLE><PARAGRAPH>This chapter is designed to educate the system administrator on the differences between communications under Trusted IRIX/CMW and under standard IRIX. It is assumed that the system administrator is familiar with networking software as described in the guide titled <EXTREF IDREF="97829" BOOK="IA_NetwkMail" FILE="" HDG="97829" INFO="">IRIX Admin: Networking and Mail</EXTREF>
. Where information in this chapter differs from the information presented in other IRIX documentation, this chapter must be considered authoritative for Trusted IRIX/CMW.</PARAGRAPH>
<PARAGRAPH>The following sections are included:</PARAGRAPH>
<BULLETLIST><BULLET><PARAGRAPH><XREF IDREF="65655" TYPE="TITLE">&ldquo;Introduction to network security&rdquo;</XREF></PARAGRAPH>
</BULLET>
<BULLET><PARAGRAPH><XREF IDREF="45094" TYPE="TITLE">&ldquo;Theory of TSIX Networking&rdquo;</XREF></PARAGRAPH>
</BULLET>
<BULLET><PARAGRAPH><XREF IDREF="14789" TYPE="TITLE">&ldquo;Trusted Network Preparation and Configuration&rdquo;</XREF></PARAGRAPH>
</BULLET>
<BULLET><PARAGRAPH><XREF IDREF="31442" TYPE="TITLE">&ldquo;rhost.conf Database&rdquo;</XREF></PARAGRAPH>
</BULLET>
<BULLET><PARAGRAPH><XREF IDREF="28530" TYPE="TITLE">&ldquo;iflabel Command&rdquo;</XREF></PARAGRAPH>
</BULLET>
<BULLET><PARAGRAPH><XREF IDREF="69312" TYPE="TITLE">&ldquo;Domains of Translation and Interpretation (DOT and DOI)&rdquo;</XREF></PARAGRAPH>
</BULLET>
<BULLET><PARAGRAPH><XREF IDREF="87776" TYPE="TITLE">&ldquo;The inetd Network Service Daemon&rdquo;</XREF></PARAGRAPH>
</BULLET>
<BULLET><PARAGRAPH><XREF IDREF="95646" TYPE="TITLE">&ldquo;Miscellaneous Trusted Network Information&rdquo;</XREF></PARAGRAPH>
</BULLET>
</BULLETLIST>
<SECTION1 LBL="" HELPID = ""><TITLE><XREFTARGET ID="65655">Introduction to network security</TITLE><PARAGRAPH>A central concept to the Silicon Graphics product family is that the most effective way to bring computing power to the individual is to connect the workstations and produce a unified system of great power. The heart of the Trusted IRIX/CMW multiple workstation system is the network. This connection allows the workstations that make up a Trusted IRIX/CMW system to share a common set of files by use of the NFS filesystem sharing protocol. It also allows computing resources to be shared via TCP/IP protocols. This mechanism allows file resources to be shared among users, who  find a single filesystem presented to them, while still providing the convenience and security of a personal workstation.<INDEXTARGET ID="ch41"><!-- POSTPROCESSDATA: ch41|networking:general --><INDEXTARGET ID="ch42"><!-- POSTPROCESSDATA: ch42|E-bus:general --><INDEXTARGET ID="ch43"><!-- POSTPROCESSDATA: ch43|coaxial bus --><INDEXTARGET ID="ch44"><!-- POSTPROCESSDATA: ch44|Ethernet bus --><INDEXTARGET ID="ch45"><!-- POSTPROCESSDATA: ch45|NFS under Trusted IRIX/B --><INDEXTARGET ID="ch46"><!-- POSTPROCESSDATA: ch46|TCP/IP under Trusted IRIX/B --></PARAGRAPH>
<PARAGRAPH>The key premise of trusted networking is that arbitrary and capricious information is never encountered. In order for this to work, the networks must be physically secure, the systems connected to the network must be appropriately administered, and the systems may either be trusted to enforce the network security policy, or are otherwise trusted and cleared to the network high label at all times.</PARAGRAPH>
<PARAGRAPH>The network is a critical part of each system's TCB and must be subject to the same security standards that prevent inappropriate access to your Trusted IRIX/CMW workstation. The physical hardware of the Ethernet cable and the connection points between the workstations and the cable must be secured.</PARAGRAPH>
<PARAGRAPH>Many users assume that any number of separate physical computers connected via coaxial cable defines a network. This, however, is not the case. A network is an uncontrolled data communication system, and not only can arbitrary and capricious  information be encountered, but it must be expected. </PARAGRAPH>
<PARAGRAPH>The network under Trusted IRIX/CMW is a restricted system interconnect. The security of the system depends upon the proper use of the hardware and the software. The purpose of trusted networking is to properly label data that is imported or exported from the system, and to appropriately enforce the system security policy on that data.</PARAGRAPH>
<PARAGRAPH>For a more general discussion of networking theory and practice, the following books, available at any computer bookstore, are recommended:</PARAGRAPH>
<PARAGRAPH><DOCTITLE>Internetworking With TCP/IP&mdash;Principles, Protocols, and Architecture</DOCTITLE>, by Douglas Comer, published by Prentice-Hall.</PARAGRAPH>
<PARAGRAPH><DOCTITLE>UNIX Network Programming</DOCTITLE>, by W. Richard Stevens, published by Prentice-Hall.</PARAGRAPH>
</SECTION1>
<SECTION1 LBL="" HELPID = ""><TITLE><XREFTARGET ID="45094">Theory of TSIX Networking</TITLE><PARAGRAPH>Mandatory Access Control is one of the primary means by which the system enforces your security policy. In order for your network to be trusted, the network must also support the mandatory access control rules of your security policy.</PARAGRAPH>
<PARAGRAPH>Not all sites may be homogeneous; that is, systems from different vendors may be on your trusted network, and perhaps not all are trusted multilevel systems. Yet all systems need to interoperate. The TSIX standard has been created to expand IP support of MAC labels in a way that allows various vendors and trusted sites to interoperate. <INDEXTARGET ID="ch47"><!-- POSTPROCESSDATA: ch47|TSIX Session Manager standard --></PARAGRAPH>
<PARAGRAPH>Under the TSIX system, labeling occurs at two levels:</PARAGRAPH>
<BULLETLIST><BULLET><PARAGRAPH>At the network interface level, IP Security Options are used to route traffic. There are several forms of IP Security Options, of which the most common are RIPSO (Revised Internet Protocol Security Option) and CIPSO (Commercial Internet Protocol Security Option).  A received packet either has CIPSO or RIPSO options, or is unlabeled. <INDEXTARGET ID="ch48"><!-- POSTPROCESSDATA: ch48|IP security options --></PARAGRAPH>
<PARAGRAPH>In the case of CIPSO options, the sensitivity label is extracted, and if it is not within the label range of the interface it is dropped. In the case of an unlabeled packet, the sensitivity label is obtained from the default label of the interface if present, or from the host or network entry in the <FILENAME></FILENAME>
<XREF IDREF="85223" TYPE="TEXT">/etc/rhost.conf</XREF><FILENAME></FILENAME> database. If the default label is not within the range of the interface, the packet is dropped.</PARAGRAPH>
<PARAGRAPH>An integrity label range may be specified for the network interface. If an integrity range is present, the integrity portion of the label from the SGIPSO tag is used for the label range comparison; otherwise, the default integrity for either the interface or host is used similar to the procedure for unlabeled packet processing.</PARAGRAPH>
<PARAGRAPH>For packets that are simply routed, or that require a reply from the TCB (such as ICMP echo packets), the outgoing packets receive the same label as the incoming packets. That label is used for a label range check against the outgoing interface, and the packet is dropped if it is not within range.</PARAGRAPH>
<PARAGRAPH>For TSIX hosts, the IP header label is no longer used for policy. For unlabeled and non-TSIX hosts the IP label is used for any further policy decisions.</PARAGRAPH>
</BULLET>
<BULLET><PARAGRAPH>At the CMW session manager level, Security Attribute Modulation Protocol (SAMP) and Security Attribute Token Mapping Protocol (SATMP) are used to send all the security attributes required to enforce security policy between network components. </PARAGRAPH>
<PARAGRAPH>For TSIX hosts, the security attributes are provided in the SAMP header. Attributes identified as mandatory that are not present in the SAMP header are first supplied from the interface and then from the <FILENAME>rhost.conf</FILENAME> entry. The <FILENAME>/etc/rhost.conf</FILENAME> file is a database of information about the network security idioms used by all hosts in your trusted network. If not all mandatory attributes are present, the packet is dropped in the case of UDP, or the connection is closed for TCP. The session manager maintains a composite set of attributes for the socket that consists of the last modulated attributes and any defaults. These composite attributes are the attributes used to enforce policy on delivery to applications, and are available to trusted applications through the TSIX API.</PARAGRAPH>
<PARAGRAPH>For UDP SAMP, attributes accompany each packet. For TCP, on initial connection the full set of attributes are exchanged before control is passed back to the application. If the attributes received from the remote host are not within the range of the user process, the connection is dropped with <COMMAND>reset</COMMAND>. A server process never sees the failed connection attempt, and the client sees the message <SCREENDISPLAY>connection closed by remote host.</SCREENDISPLAY></PARAGRAPH>
</BULLET>
</BULLETLIST>
<SECTION2 LBL="" HELPID = ""><TITLE>TSIX Security Policy</TITLE><PARAGRAPH>The policies enforced by trusted networking are as follows:<INDEXTARGET ID="ch49"><!-- POSTPROCESSDATA: ch49|TSIX security policy --></PARAGRAPH>
<BULLETLIST><BULLET><PARAGRAPH>Received packets must be within the label range of the interface and the host or network.</PARAGRAPH>
</BULLET>
<BULLET><PARAGRAPH>Delivered data must have a label dominated by the receiving process. </PARAGRAPH>
</BULLET>
<BULLET><PARAGRAPH>Trusted processes may themselves enforce appropriate policy. </PARAGRAPH>
</BULLET>
</BULLETLIST>
</SECTION2>
</SECTION1>
<SECTION1 LBL="" HELPID = ""><TITLE><XREFTARGET ID="14789">Trusted Network Preparation and Configuration</TITLE><PARAGRAPH>The following  sections  deal with the steps involved in preparing a number of Trusted IRIX/CMW workstations to operate on a network. The possibilities in a heterogeneous environment are too numerous to document, but enough background is provided to instruct you in the necessary tasks that must be performed.<INDEXTARGET ID="ch410"><!-- POSTPROCESSDATA: ch410|networking:preparing for --></PARAGRAPH>
<PARAGRAPH>To create your Trusted IRIX/CMW network, you must first assemble your system and network hardware according to the instructions provided in the hardware package. Once the system is assembled, install your Trusted IRIX/CMW system distribution media on each system and you are ready to begin.<INDEXTARGET ID="ch411"><!-- POSTPROCESSDATA: ch411|configuring Trusted IRIX/B --><INDEXTARGET ID="ch412"><!-- POSTPROCESSDATA: ch412|operating system configuration --><INDEXTARGET ID="ch413"><!-- POSTPROCESSDATA: ch413|IRIX configuration --></PARAGRAPH>
<CAUTION><PREFIX>Caution</PREFIX>Your trusted network  operates most smoothly if the security labels used on each system are the same, and have the same meanings, as those on every other system (that is, one set of labels for the network). Careful planning before you create your trusted systems is of great value when you create your network.</CAUTION>
<PARAGRAPH>Note that all network daemons, including <COMMAND>nfsd</COMMAND> and <COMMAND>inetd</COMMAND>, must be run at the same (or equivalent) labels on each system on your network. This is usually the administrative low label, <ITALICS>dblow</ITALICS><VARIABLE>,</VARIABLE> on Trusted IRIX/CMW systems. If this is not the case, the daemons cannot find each other and communicate, and thus do not function properly. Label cognizant daemons such as <COMMAND>nfsd</COMMAND> and <COMMAND>inetd </COMMAND>enforce the MAC policy themselves, instead of relying on the operating system to enforce it for them, but all other network-related daemons (such as <COMMAND>timed</COMMAND>, <COMMAND>routed</COMMAND>, <COMMAND>yp</COMMAND>, and so on) are not label-cognizant and must always be interoperated at a single pre-defined label.</PARAGRAPH>
<PARAGRAPH>Some sites find that all systems on the network share the same set of labels (such as <ITALICS>unclassified</ITALICS>, <ITALICS>confidential</ITALICS>, <ITALICS>secret</ITALICS>, <ITALICS>top secret</ITALICS>, and so on) and while the relationship between the levels is the same, the integer values to represent them may be different. For example, the integer value of <ITALICS>confidential</ITALICS> is always less than the integer value of <ITALICS>secret</ITALICS>, but one system might have specified the <ITALICS>secret</ITALICS> label with an integer value of 3, and another may have used an integer value of 30 for the same <FILENAME>secret</FILENAME> label. This creates the need for software to interpret and equalize labels if all the systems do not share an identical label set.</PARAGRAPH>
<PARAGRAPH>Add to these situations the extra levels of specificity used to create MAC categories, and the process of defining the rules of translation for labels from different systems can become quite complex.</PARAGRAPH>
<PARAGRAPH>Labels transmitted on the network are tagged with a Domain of Interpretation (DOI). These tags tell each system how to map the bit representation of the incoming sensitivity label into the native bit representation.</PARAGRAPH>
<PARAGRAPH>As long as all systems in your network have the same native representation (they require no mapping), the network MAC policy works transparently. The network uses DOI 3 (which means native representation as determined by the local label database) and all packets with DOIs other than 3 are dropped. </PARAGRAPH>
<SECTION2 LBL="" HELPID = ""><TITLE>Label Restrictions on Network Services</TITLE><PARAGRAPH>All network services bear the restriction that the user must be cleared on the remote system at the label he or she is currently using on the local system. For example, if a user is logged in at the label <INDEXTARGET ID="ch414"><!-- POSTPROCESSDATA: ch414|labels:restrictions on network services --><ITALICS>usermiddle</ITALICS> on a system and attempts to rn the <COMMAND>rlogin</COMMAND> program on a remote system, the attempt cannot succeed unless the user is also cleared for the <ITALICS>usermiddle</ITALICS> label on the remote host. If the user's maximum clearance is <ITALICS>userlow</ITALICS> on the remote system, the <ITALICS>rlogin</ITALICS> attempt fails.</PARAGRAPH>
<PARAGRAPH>When using network services to log in to remote hosts, no provision is made for entering a label on the remote host. The user must conduct all transactions with the remote host at the current label on the local host. This restriction prevents writedown of data.</PARAGRAPH>
</SECTION2>
<SECTION2 LBL="" HELPID = ""><TITLE>Creating an Interoperating Heterogeneous Network</TITLE><PARAGRAPH>If you have a heterogeneous environment, the following steps should help you create an interoperating network. Trusted systems from different vendors are not likely to have the same feature sets, and those features that are similar in use may be implemented in radically different ways. Follow these steps:<INDEXTARGET ID="ch415"><!-- POSTPROCESSDATA: ch415|networking:interoperating heterogeneous --><INDEXTARGET ID="ch416"><!-- POSTPROCESSDATA: ch416|interoperating heterogeneous network --></PARAGRAPH>
<ORDEREDLIST><LIST><PARAGRAPH>Every system should have DOI set to 3.</PARAGRAPH>
</LIST>
<LIST><PARAGRAPH>Determine a set of labels and categories to use and their integer values. </PARAGRAPH>
</LIST>
<LIST><PARAGRAPH>Change all label databases to match the selected set of network labels. On your Trusted IRIX/CMW systems, edit the <FILENAME>/etc/mac</FILENAME> file.</PARAGRAPH>
</LIST>
<LIST><PARAGRAPH>Specify a default integrity label for the network. The incoming sensitivity label and the default integrity label are combined on each packet to create the MAC label that is used to enforce your security policy.</PARAGRAPH>
</LIST>
</ORDEREDLIST>
<PARAGRAPH>For more information on interoperating and trusted systems, read the material provided on the Trusted Systems Interoperability Group (TSIG) site on the World Wide Web (<INDEXTARGET ID="ch417"><!-- POSTPROCESSDATA: ch417|Trusted Systems Interoperability Group (TSIG) --><LAUNCHWORD APP="/usr/sbin/nr" PARMS="http://www.sterling.com/ftp/tsig">http://www.sterling.com/ftp/tsig</LAUNCHWORD>
).</PARAGRAPH>
</SECTION2>
<SECTION2 LBL="" HELPID = ""><TITLE>Creating a Homogeneous Network of Trusted IRIX/CMW Systems</TITLE><PARAGRAPH>Trusted IRIX/CMW has significant differences from other trusted operating systems. One of these differences is the SGIPSO2 protocol. This protocol includes administrative labels, integrity labels, and user IDs. If you use a full Trusted IRIX/CMW label set, you can only fully make use of your label set with other Trusted IRIX/CMW systems. <INDEXTARGET ID="ch418"><!-- POSTPROCESSDATA: ch418|SGIPSO2 protocol --></PARAGRAPH>
<PARAGRAPH>The full label set is required by Trusted IRIX/CMW systems to enforce security policy in the evaluated configuration. </PARAGRAPH>
<PARAGRAPH>Trusted systems generally have a system high label&mdash;a label that dominates all other labels on the system, and a system low label&mdash;a label that is dominated by all other labels on the system. These labels are generally required for administrative activities. For example, when performing a system backup you must be logged in at the system high label. In trusted systems other than Trusted IRIX/CMW, these labels have to be calculated based on the configuration in the label database. <INDEXTARGET ID="ch419"><!-- POSTPROCESSDATA: ch419|labels:system high --><INDEXTARGET ID="ch420"><!-- POSTPROCESSDATA: ch420|labels:system low --></PARAGRAPH>
<PARAGRAPH>Trusted IRIX/CMW has implemented label types. There are label types for the high label, the low label, the auditor, and a type for ordinary labels. There is no mechanism except for the SGIPSO2 protocol for communication of administrative labels to nonTrusted IRIX/CMW systems. A similar issue is raised by using default integrity labels.  The full range of labels that can be represented on a Trusted IRIX/CMW system cannot be communicated across the network. This is not an insurmountable problem, however, because if your users know what labels are cleared for network use, they can change their operating label to an acceptable label before using the network.<INDEXTARGET ID="ch421"><!-- POSTPROCESSDATA: ch421|labels:types --></PARAGRAPH>
<PARAGRAPH>In order for a system to communicate with another host on your network: </PARAGRAPH>
<ORDEREDLIST><LIST><PARAGRAPH>The host must have an entry in the <FILENAME>rhost.conf</FILENAME> database. (Wildcard entries are permitted.)</PARAGRAPH>
</LIST>
<LIST><PARAGRAPH>The &ldquo;next hop&rdquo; host must have an entry in the <FILENAME>rhost.conf</FILENAME> database.</PARAGRAPH>
</LIST>
<LIST><PARAGRAPH>The interface must be labeled using the<COMMAND>&space;iflabel</COMMAND> command.</PARAGRAPH>
</LIST>
<LIST><PARAGRAPH>The packet must have a label within the range of all of the above conditions.</PARAGRAPH>
</LIST>
</ORDEREDLIST>
</SECTION2>
</SECTION1>
<SECTION1 LBL="" HELPID = ""><TITLE><XREFTARGET ID="31442">rhost.conf Database</TITLE><PARAGRAPH>The <FILENAME>rhost.conf</FILENAME> database describes the MAC label interaction between your system and every other system on your trusted network. This database describes default labels to use for networking to non-trusted hosts and the idiom of network label support used for trusted multi-label hosts. All information relevant to trusted networking for each host on your network is stored in this file on each system. You must manually enter each host in your trusted network in your <INDEXTARGET ID="ch422"><!-- POSTPROCESSDATA: ch422|rhost.conf database --><FILENAME>rhost.conf</FILENAME> file, along with the idiom of label support used by that host.</PARAGRAPH>
<PARAGRAPH>To create your <ITALICS>rhost.conf</ITALICS> database, take the sample <FILENAME>/etc/rhost.conf</FILENAME> file distributed with Trusted IRIX/CMW and edit it, adding each host's entry individually. </PARAGRAPH>
<SECTION2 LBL="" HELPID = ""><TITLE>rhost.conf File Syntax</TITLE><PARAGRAPH>The following sections describe the syntax of the <FILENAME>rhost.conf</FILENAME> file:</PARAGRAPH>
<BULLETLIST><BULLET><PARAGRAPH>Templates in rhost.conf</PARAGRAPH>
</BULLET>
<BULLET><PARAGRAPH>Individual Host Entries in rhost.conf</PARAGRAPH>
</BULLET>
<BULLET><PARAGRAPH>Wildcard Entries in rhost.conf</PARAGRAPH>
</BULLET>
</BULLETLIST>
<SECTION3 LBL="" HELPID = ""><TITLE>Templates in rhost.conf</TITLE><PARAGRAPH>The information at the top of the <FILENAME>rhost.conf</FILENAME> file specifies templates for hosts that fulfill certain common requirements for label interchange. The syntax allows you to create custom host templates as well. At the bottom of the <FILENAME>rhost.conf</FILENAME> file, an entry that is similar to this</PARAGRAPH>
<EXAMPLE>
<ITALICS>Hostname</ITALICS>:    default_spec = default_sgipso:
</EXAMPLE>
<PARAGRAPH>is specifying a previously defined template (in this case, <VARIABLE>default_sgipso</VARIABLE>, which is reprinted in the following template).</PARAGRAPH>
<PARAGRAPH>If you have planned your trusted network well, using a common set of labels, you should be able to use the provided templates as distributed for your hosts. Several templates are provided for commonly used labeling idioms.</PARAGRAPH>
<PARAGRAPH>The following template is reprinted here as an example:</PARAGRAPH>
<CODE>
################################################################
# SGIPSO2 Trix5.3/4.0.5 Hosts
# 
################################################################
default_sgipso: nlm_type = sgipso2:\
smm_type = single_level:\
doi = cipso_tsig:\
default_spec = .:\
max_privs = CAP_CHOWN,CAP_SETGID,CAP_SETUID,CAP_DAC_EXECUTE+eip:\
cache_size = 512:\
flags = mand_sl,import,export:\
def_privs = CAP_CHOWN,CAP_SETGID,CAP_SETUID,CAP_DAC_EXECUTE+eip:\
def_luid = root:\
def_uid = root:\
def_gid = root:\
def_ngrps = 1:\
def_gids = sys:\
def_sid = 0:\
def_sl = userlow:\
def_clearance = userlow:\
def_ilb = userlow:\
min_sl = userlow:\
max_sl = userlow:
</CODE>
</SECTION3>
<SECTION3 LBL="" HELPID = ""><TITLE>Individual Host Entries in rhost.conf</TITLE><PARAGRAPH>A specific host entry in an <FILENAME>rhost.conf</FILENAME> file follows the same syntax as a template entry, and can either specify all attributes, or use some combination of a template and an individual specification:</PARAGRAPH>
<CODE>
# anewhost:\
#       default_spec = default_tsix_1_0:\
#       min_sl       = confidential:\
#       max_sl       = secret:
</CODE>
<PARAGRAPH>This example uses a template to describe most attributes, and the minimum and maximum label are specified for the host.</PARAGRAPH>
<PARAGRAPH>The localhost must always be specified as well:</PARAGRAPH>
<CODE>
# Always put host and localhost 
host:           default_spec = default_tsig:
localhost:      default_spec = default_tsig:
</CODE>
<PARAGRAPH>The following examples show how individual hosts may be specified using templates. Note that hosts may be specified by name or by IP address. Also, note that the second entry is a wildcard entry, which is described in <XREF IDREF="26135" TYPE="TITLE">&ldquo;Wildcard Entries in rhost.conf.&rdquo;</XREF></PARAGRAPH>
<HANGLIST><HANGPAIR><HANGITEM><SCREENDISPLAY>pender:</SCREENDISPLAY></HANGITEM>
<HANGBODY><PARAGRAPH><SCREENDISPLAY>default_spec = default_sgipso:</SCREENDISPLAY></PARAGRAPH>
</HANGBODY>
</HANGPAIR>
<HANGPAIR><HANGITEM><SCREENDISPLAY>154.16.0.0:</SCREENDISPLAY></HANGITEM>
<HANGBODY><PARAGRAPH><SCREENDISPLAY>default_spec = default_single_level:</SCREENDISPLAY></PARAGRAPH>
</HANGBODY>
</HANGPAIR>
<HANGPAIR><HANGITEM><SCREENDISPLAY>192.88.83.26:</SCREENDISPLAY></HANGITEM>
<HANGBODY><PARAGRAPH><SCREENDISPLAY>default_spec = default_single_level:</SCREENDISPLAY></PARAGRAPH>
</HANGBODY>
</HANGPAIR>
<HANGPAIR><HANGITEM><SCREENDISPLAY>howard:</SCREENDISPLAY></HANGITEM>
<HANGBODY><PARAGRAPH><SCREENDISPLAY>default_spec = default_tsig:</SCREENDISPLAY></PARAGRAPH>
</HANGBODY>
</HANGPAIR>
<HANGPAIR><HANGITEM><SCREENDISPLAY>hancock:</SCREENDISPLAY></HANGITEM>
<HANGBODY><PARAGRAPH><SCREENDISPLAY>default_spec = default_cipso:</SCREENDISPLAY></PARAGRAPH>
</HANGBODY>
</HANGPAIR>
</HANGLIST>
</SECTION3>
<SECTION3 LBL="" HELPID = ""><TITLE><XREFTARGET ID="26135">Wildcard Entries in rhost.conf</TITLE><PARAGRAPH>A wildcard entry is an IP address with zeros in some positions. For example, consider the following IP format addresses from an <FILENAME>rhost.conf</FILENAME> file:</PARAGRAPH>
<CODE>
128.01.01.0:
128.01.0.0:
128.0.0.0
0.0.0.0:
</CODE>
<PARAGRAPH>All these are wildcard entries with increasing scope as you move down the list. When looking up a specific network address in response to a user command, a system must first search for the whole address, and then successively withdraw a byte and look for a wildcard match. This allows the following strategy to work: Consider that a user has requested a file transfer from a specific host. The operating system must determine what label interchange arrangement exists with that host, so it begins by looking up the host's entry in the <FILENAME>rhost.conf</FILENAME> database. The IP address being searched for is 128.01.01.01. The <FILENAME>rhost.conf</FILENAME> database could hold any of the following entries:</PARAGRAPH>
<HANGLIST><HANGPAIR><HANGITEM>128.01.01.01:</HANGITEM>
<HANGBODY><PARAGRAPH>This is the host that is needed. Use its specific entry from the database.</PARAGRAPH>
</HANGBODY>
</HANGPAIR>
<HANGPAIR><HANGITEM>128.01.01.0:</HANGITEM>
<HANGBODY><PARAGRAPH>This entire subnetwork is defined to use a single entry from the database (partial wildcard entry).</PARAGRAPH>
</HANGBODY>
</HANGPAIR>
<HANGPAIR><HANGITEM>0.0.0.0:</HANGITEM>
<HANGBODY><PARAGRAPH>The whole network is untrusted and is communicated with only at the default label (100% wildcard entry).</PARAGRAPH>
</HANGBODY>
</HANGPAIR>
</HANGLIST>
</SECTION3>
</SECTION2>
<SECTION2 LBL="" HELPID = ""><TITLE>The rhost Command</TITLE><PARAGRAPH>The <COMMAND>rhost</COMMAND> command, without any options, loads the default configuration file, <FILENAME>/etc/rhost.conf,</FILENAME> into your kernel for use by the network. The following options are available to the <COMMAND>rhost</COMMAND> command:</PARAGRAPH>
<HANGLIST><HANGPAIR><HANGITEM><VARIABLE>-l hostname</VARIABLE></HANGITEM>
<HANGBODY><PARAGRAPH>Displays the characteristics of the current host</PARAGRAPH>
</HANGBODY>
</HANGPAIR>
<HANGPAIR><HANGITEM><VARIABLE>-f filename</VARIABLE></HANGITEM>
<HANGBODY><PARAGRAPH>Loads an alternate file into the kernel.</PARAGRAPH>
</HANGBODY>
</HANGPAIR>
</HANGLIST>
<PARAGRAPH>The syntax of the input file is modeled after the <FILENAME>rhost.conf </FILENAME>database description found on the TSIG site on the World Wide Web (<LAUNCHWORD APP="/usr/sbin/nr" PARMS="http://www.sterling.com/ftp/tsig">http://www.sterling.com/ftp/tsig</LAUNCHWORD>
).</PARAGRAPH>
</SECTION2>
</SECTION1>
<SECTION1 LBL="" HELPID = ""><TITLE><XREFTARGET ID="28530">iflabel Command</TITLE><PARAGRAPH>The <COMMAND>iflabel </COMMAND>command is used to assign a specific set of trusted networking rules (called an idiom) to a network interface and to configure the network interface label parameters. This is done because trusted networking requires that all packets sent over the network must retain their security classifications and other attributes, unless specific policy is in place. Because your trusted system may be in heterogeneous operation with other trusted and untrusted systems, several idioms of network labeling are allowed to maximize interoperability. </PARAGRAPH>
<PARAGRAPH>For complete information on the use and parameters of <COMMAND>iflabel</COMMAND>, see the <REFPAGE>iflabel</REFPAGE>(1) reference page.</PARAGRAPH>
<PARAGRAPH>The<COMMAND>&space;iflabel</COMMAND> command is invoked at boot time from <COMMAND>/etc/rc2.d/network</COMMAND> to define the label exchange idiom of each network interface present on the system; you may also use it once the system is running to redefine an interface's idiom or other label parameters. However, it is generally considered good system administration practice to change the <COMMAND>iflabel</COMMAND> configuration file and then to reboot the system in order to change the idiom of a network interface. There is one configuration file, called <FILENAME>/etc/config/iflabel-?.options</FILENAME> for each network interface on your system. The actual filenames replace the question mark with the code for the particular interface, for example, <FILENAME>ec0</FILENAME>. Use the <COMMAND>netstat -i</COMMAND> command to list your system's network interfaces.</PARAGRAPH>
<PARAGRAPH>Only the superuser may modify the configuration of a network interface. The <COMMAND>iflabel </COMMAND>command may be invoked with any of several idioms, or with none at all. If <COMMAND>iflabel </COMMAND>is invoked with no idiom or label parameters, it displays the current idiom for the specified network interface and the current values of the parameters appropriate to that idiom.</PARAGRAPH>
<PARAGRAPH>The <COMMAND>iflabel</COMMAND> command may be invoked with any one of these idioms:</PARAGRAPH>
<HANGLIST><HANGPAIR><HANGITEM>MONO</HANGITEM>
<HANGBODY><PARAGRAPH>This idiom is used when a trusted multi-level host (such as a Trusted IRIX/CMW system) is attached to a single level (possibly untrusted) network. Datagrams sent between hosts on a single level network do not contain labels in their IP option subheader; all traffic on a single level network is defined to take place at the label of the network. </PARAGRAPH>
</HANGBODY>
</HANGPAIR>
<HANGPAIR><HANGITEM>BSO </HANGITEM>
<HANGBODY><PARAGRAPH>All network traffic over a BSO interface must be at a label dominated by the highest label of the network interface and dominating the lowest label of the interface.</PARAGRAPH>
</HANGBODY>
</HANGPAIR>
<HANGPAIR><HANGITEM>BSO_TX</HANGITEM>
<HANGBODY><PARAGRAPH>This idiom is precisely like BSO except that labels are always                transmitted with outgoing datagrams but not required on incoming datagrams.</PARAGRAPH>
</HANGBODY>
</HANGPAIR>
<HANGPAIR><HANGITEM>CIPSO2</HANGITEM>
<HANGBODY><PARAGRAPH>All network traffic over a CIPSO2 interface must be at a label dominated by the highest label of the interface and dominating the lowest label of the interface.</PARAGRAPH>
</HANGBODY>
</HANGPAIR>
<HANGPAIR><HANGITEM>SGIPSO2</HANGITEM>
<HANGBODY><PARAGRAPH>This idiom, an extension to CIPSO2, provides a mechanism to attach to all network traffic, a complete Silicon Graphics MAC (mandatory access control) label, along with the user ID of the sending process. Besides a sensitivity level and a category set, the MAC label may include integrity components and label types other than TCSEC, EXACT, and BIBA. </PARAGRAPH>
</HANGBODY>
</HANGPAIR>
</HANGLIST>
</SECTION1>
<SECTION1 LBL="" HELPID = ""><TITLE><XREFTARGET ID="69312">Domains of Translation and Interpretation (DOT and DOI)</TITLE><PARAGRAPH>You can create an interoperating heterogeneous network with a limited label set, but if you wish to make full use of Trusted IRIX/CMW features, such as the windowing system and shared filesystems, you must use the full set of security attributes to appropriately enforce the security policy of the system. </PARAGRAPH>
<PARAGRAPH>The TSIX standard is a specification of a session layer protocol for passing all attributes needed to completely enforce security policy between two systems. There is a set of attributes that may be necessary, depending on your security policy, to enforce your policy. The communicating hosts may agree to send all, some, or none of the security attributes from the following set:<INDEXTARGET ID="ch423"><!-- POSTPROCESSDATA: ch423|TSIX Session Manager standard --></PARAGRAPH>
<BULLETLIST><BULLET><PARAGRAPH>Sensitivity label</PARAGRAPH>
</BULLET>
<BULLET><PARAGRAPH>Nationality Caveats</PARAGRAPH>
</BULLET>
<BULLET><PARAGRAPH>Integrity label</PARAGRAPH>
</BULLET>
<BULLET><PARAGRAPH>TSIX Session ID</PARAGRAPH>
</BULLET>
<BULLET><PARAGRAPH>Clearance</PARAGRAPH>
</BULLET>
<BULLET><PARAGRAPH>Process Access Control List (ACL)</PARAGRAPH>
</BULLET>
<BULLET><PARAGRAPH>Information label</PARAGRAPH>
</BULLET>
<BULLET><PARAGRAPH>Capability set</PARAGRAPH>
</BULLET>
<BULLET><PARAGRAPH>Login (audit) ID</PARAGRAPH>
</BULLET>
<BULLET><PARAGRAPH>Process ID                </PARAGRAPH>
</BULLET>
<BULLET><PARAGRAPH>Discretionary ID</PARAGRAPH>
</BULLET>
<BULLET><PARAGRAPH>Additional client audit info</PARAGRAPH>
</BULLET>
<BULLET><PARAGRAPH>Process Attributes</PARAGRAPH>
</BULLET>
</BULLETLIST>
<PARAGRAPH>The protocol used to communicate the attributes between systems is SAMP. This is a header and a list of attributes that is prepended to outgoing data as if it were user data. The TCB at each end of the connection has to put this information on, and pull it off and use it before the &ldquo;real&rdquo; data is passed to the user program.</PARAGRAPH>
<PARAGRAPH>Under Trusted IRIX/CMW, each attribute is represented in ASCII form. The ASCII representation is the same as your label name, for example, <ITALICS>TOP SECRET</ITALICS>. User and Group ID numbers are also an ASCII user or group name. Each attribute has its own defined formats in the SAMP standard. </PARAGRAPH>
<PARAGRAPH>Trusted IRIX/CMW converts the ASCII representations to a 32-bit token that is prepended to the packet for transfer. The SATMP protocol defines these tokens.</PARAGRAPH>
<PARAGRAPH>When two systems communicate over the network, they first perform a SATMP handshake. During this handshake, the two systems negotiate which predefined Domain of Translation they have in common for each required attribute in the SAMP protocol. Your <INDEXTARGET ID="ch424"><!-- POSTPROCESSDATA: ch424|Domains of Translation --><FILENAME>rhost.conf</FILENAME> database specifies which attributes are required of the remote host, and what defaults may be substituted if the remote host cannot supply a particular attribute. Your DOT are established as you build your network's <FILENAME>rhost.conf</FILENAME> database.</PARAGRAPH>
<PARAGRAPH>The remote host database also allows the system to distinguish which hosts it can use TSIX to communicate with, which have only IP Options (such as CIPSO), which are unlabeled, and what level of trust to give each type of host. For example, you can specify that your system communicate with unlabeled hosts, but for purposes of enforcing policy, treat all communication as if it is unclassified, low integrity, and the user is <ITALICS>guest</ITALICS> with no capabilities. This specification happens in the <FILENAME>rhost.conf</FILENAME> file.</PARAGRAPH>
<PARAGRAPH>If the two hosts attempting to communicate can not find a common DOT for each attribute or supply appropriate defaults, no communication happens. This protects system security.</PARAGRAPH>
<PARAGRAPH>A well-planned network implements user ID and group ID numbers centrally, so that they are identical across the entire network. If this is the case, these numbers need not be mapped. Similarly, capabilities and labels should also be identical across your network.</PARAGRAPH>
<SECTION2 LBL="" HELPID = ""><TITLE>Domains of Translation and Heterogeneous Networks</TITLE><PARAGRAPH>Within an organization of Trusted IRIX/CMW systems and users, there may exist different subgroups of users and systems that use different sets of label hierarchies and categories. For example, one group may have sensitivity levels that are named <ITALICS>Unclassified</ITALICS>, <ITALICS>Confidential</ITALICS>, <ITALICS>Secret</ITALICS>, and <ITALICS>Top Secret</ITALICS> and categories named after military weapons systems, while another group may have sensitivity levels called <ITALICS>Public</ITALICS>, <ITALICS>Company Confidential</ITALICS>, <ITALICS>Management Only</ITALICS>, <ITALICS>Directors Only</ITALICS>, and <ITALICS>CEO Only</ITALICS>, and may have categories named <ITALICS>Payroll</ITALICS>, <ITALICS>Hardware Engineering</ITALICS>, and <ITALICS>OS Software</ITALICS>.</PARAGRAPH>
<PARAGRAPH>In a heterogeneous environment, you have several options:</PARAGRAPH>
<ORDEREDLIST><LIST><PARAGRAPH>Hosts can be unlabeledx Security attributes are implied by the default definition in the <FILENAME>rhost.conf</FILENAME> file.</PARAGRAPH>
</LIST>
<LIST><PARAGRAPH>Hosts may have IP security options only, such as CIPSO. In this case the Sensitivity Label is described by the Domain of Interpretation. There is also a Trusted IRIX/CMW IP option that sends integrity label and user id number information.</PARAGRAPH>
</LIST>
<LIST><PARAGRAPH>Hosts may be TSIX hosts. In this case the host supports sending any of the standard list of attributes.</PARAGRAPH>
</LIST>
<LIST><PARAGRAPH>Not all attributes are supported on all systems. Missing attributes are implied by the use of defaults by the receiving host.</PARAGRAPH>
</LIST>
</ORDEREDLIST>
<PARAGRAPH>There is one DOT for each security attribute, and the DOT describes the interpretation of the attribute. In the case of Sensitivity labels a DOT is a mapping similar in concept to the Domain of Interpretation. </PARAGRAPH>
<PARAGRAPH>A DOT means other things for other attributes. The account called <VARIABLE>darius</VARIABLE> on one system can be matched to <ITALICS>dcouch</ITALICS> on another. user ID numbers and GID numbers usually are not mapped, because large installations usually ensure that user ID numbers are identical on all systems.</PARAGRAPH>
<PARAGRAPH>The other special case is capabilities. These are usually vendor specific mappings in a heterogeneous environment. Because the implementation of privilege is highly variable, mappings are frequently difficult or impossible, and best left to defaults.</PARAGRAPH>
</SECTION2>
<SECTION2 LBL="" HELPID = ""><TITLE>DOI/DOT Restrictions Under Trusted IRIX/CMW</TITLE><PARAGRAPH>Trusted IRIX/CMW implements only one Domain of Interpretation (DOI), DOI 3, but multiple DOTs between TSIX-supporting hosts. The mapping tables for the single DOI are identical to the contents of the files in the directory <INDEXTARGET ID="ch425"><!-- POSTPROCESSDATA: ch425|Domain of Interpretation --><FILENAME>/etc/mac_label</FILENAME>. The DOI identification number is specified for each interface using the <COMMAND>iflabel </COMMAND>program. Because Trusted IRIX/CMW supports only one DOI, the same DOI identification number should be used on all CIPSO and SGIPSO interfaces.</PARAGRAPH>
</SECTION2>
<SECTION2 LBL="" HELPID = ""><TITLE>Configuring a DOI Under Trusted IRIX/CMW</TITLE><PARAGRAPH>If systems in different groups use the same category and level names but have different number values for these names, label confusion can occur. For example, consider <XREF IDREF="78741" TYPE="TABLE">Table&nbsp;4-1</XREF>:</PARAGRAPH>
<TABLE COLUMNS="3"><CAPTION LBL="4-1"><PREFIX>Table 4-1 </PREFIX><XREFTARGET ID="78741">Label Confusion</CAPTION>
<TABLEHEADING><CELL LEFT="0" WIDTH="113"><PARAGRAPH>Label Name</PARAGRAPH>
</CELL>
<CELL LEFT="120" WIDTH="113"><PARAGRAPH>Group A Number</PARAGRAPH>
</CELL>
<CELL LEFT="240" WIDTH="113"><PARAGRAPH>Group B Number </PARAGRAPH>
</CELL>
</TABLEHEADING>
<TABLEBODY><ROW><CELL LEFT="0" WIDTH="113"><PARAGRAPH>Unclassified</PARAGRAPH>
</CELL>
<CELL LEFT="120" WIDTH="113"><PARAGRAPH>0</PARAGRAPH>
</CELL>
<CELL LEFT="240" WIDTH="113"><PARAGRAPH>10</PARAGRAPH>
</CELL>
</ROW>
<ROW><CELL LEFT="0" WIDTH="113"><PARAGRAPH>Confidential</PARAGRAPH>
</CELL>
<CELL LEFT="120" WIDTH="113"><PARAGRAPH>10</PARAGRAPH>
</CELL>
<CELL LEFT="240" WIDTH="113"><PARAGRAPH>20 </PARAGRAPH>
</CELL>
</ROW>
<ROW><CELL LEFT="0" WIDTH="113"><PARAGRAPH>Secret</PARAGRAPH>
</CELL>
<CELL LEFT="120" WIDTH="113"><PARAGRAPH>20</PARAGRAPH>
</CELL>
<CELL LEFT="240" WIDTH="113"><PARAGRAPH>30 </PARAGRAPH>
</CELL>
</ROW>
<ROW><CELL LEFT="0" WIDTH="113"><PARAGRAPH>Top Secret</PARAGRAPH>
</CELL>
<CELL LEFT="120" WIDTH="113"><PARAGRAPH>30</PARAGRAPH>
</CELL>
<CELL LEFT="240" WIDTH="113"><PARAGRAPH>40 </PARAGRAPH>
</CELL>
</ROW>
</TABLEBODY>
</TABLE>
<PARAGRAPH>Obviously, if the computers of these two groups were to begin to interoperate (for example, a gateway was added between their respective networks), then a computer in group A could send &ldquo;Secret&rdquo; data with the number 20, and when it arrived at a group B computer it is understood as &ldquo;Confidential&rdquo; data. This communication causes a writedown (downgrading) of that data. This type of situation is expressly prohibited for trusted systems.</PARAGRAPH>
<PARAGRAPH>Continuing the example, consider a group C, which uses the names Public, Company Confidential, and so on according <XREF IDREF="67026" TYPE="TABLE">Table&nbsp;4-2</XREF>. If this group adds a gateway to group A, there is a label mismatch. <XREF IDREF="67026" TYPE="TABLE">Table&nbsp;4-2</XREF> depicts the mismatch:</PARAGRAPH>
<TABLE COLUMNS="3"><CAPTION LBL="4-2"><PREFIX>Table 4-2 </PREFIX><XREFTARGET ID="67026">Label Mismatch</CAPTION>
<TABLEHEADING><CELL LEFT="0" WIDTH="113"><PARAGRAPH>Number</PARAGRAPH>
</CELL>
<CELL LEFT="120" WIDTH="113"><PARAGRAPH>Group A Name</PARAGRAPH>
</CELL>
<CELL LEFT="240" WIDTH="113"><PARAGRAPH>Group C Name</PARAGRAPH>
</CELL>
</TABLEHEADING>
<TABLEBODY><ROW><CELL LEFT="0" WIDTH="113"><PARAGRAPH>0</PARAGRAPH>
</CELL>
<CELL LEFT="120" WIDTH="113"><PARAGRAPH>Unclassified</PARAGRAPH>
</CELL>
<CELL LEFT="240" WIDTH="113"><PARAGRAPH>Public </PARAGRAPH>
</CELL>
</ROW>
<ROW><CELL LEFT="0" WIDTH="113"><PARAGRAPH>10</PARAGRAPH>
</CELL>
<CELL LEFT="120" WIDTH="113"><PARAGRAPH>Confidential</PARAGRAPH>
</CELL>
<CELL LEFT="240" WIDTH="113"><PARAGRAPH>Company Confidential </PARAGRAPH>
</CELL>
</ROW>
<ROW><CELL LEFT="0" WIDTH="113"><PARAGRAPH>20</PARAGRAPH>
</CELL>
<CELL LEFT="120" WIDTH="113"><PARAGRAPH>Secret</PARAGRAPH>
</CELL>
<CELL LEFT="240" WIDTH="113"><PARAGRAPH>Management only </PARAGRAPH>
</CELL>
</ROW>
<ROW><CELL LEFT="0" WIDTH="113"><PARAGRAPH>30</PARAGRAPH>
</CELL>
<CELL LEFT="120" WIDTH="113"><PARAGRAPH>Top Secret</PARAGRAPH>
</CELL>
<CELL LEFT="240" WIDTH="113"><PARAGRAPH>Directors only </PARAGRAPH>
</CELL>
</ROW>
</TABLEBODY>
</TABLE>
<PARAGRAPH>There is a mismatch problem if these two groups begin to interpret the numbers coming from the other system according to their own tables. Although there is a surface similarity between the numbers used to represent the labels, neither group wants its top-level information to be available to the other group. For more information on label dominance, see the <REFPAGE>dominance</REFPAGE>(5) reference page.</PARAGRAPH>
<PARAGRAPH>There may also be an overlapping situation, where some systems are able and cleared to understand multiple sets of information. For example, consider a computer that is allowed to use information according to the following hierarchy. This system is able to receive and send data securely among groups A, B, and C:</PARAGRAPH>
<EXAMPLE>
Public 
</EXAMPLE>
<CODE>
Unclassified 
Company Confidential 
Confidential 
Management Only 
Secret 
Directors Only 
Top Secret 
CEO only
</CODE>
<PARAGRAPH>To avoid writedown or overlapping, each group must have a set of mapping tables (one for sensitivity level, one for sensitivity category, one for each integrity grade and one for each integrity division). This set of tables facilitates the translation of label names onto numeric values and conversely of number values onto label names. Any such set of tables may be called a map.</PARAGRAPH>
<PARAGRAPH>Under Trusted IRIX/CMW, the actual map tables are placed into the file <FILENAME>/etc/mac</FILENAME>. The DOI identification numbers are configured onto the interfaces using the <COMMAND>iflabel</COMMAND> program. For convenience, the file <FILENAME>/etc/config/netif.options</FILENAME> contains the <COMMAND>iflabel</COMMAND> commands that are routinely run at system start-up. The <VARIABLE>netif.options</VARIABLE> is a good place to put the DOI identification numbers.</PARAGRAPH>
</SECTION2>
</SECTION1>
<SECTION1 LBL="" HELPID = ""><TITLE><XREFTARGET ID="87776">The inetd Network Service Daemon</TITLE><PARAGRAPH>Most of the network services offered by a host system are offered through a program called<COMMAND>&space;inetd</COMMAND>. This daemon is run automatically during system startup if the network has been turned on with the <COMMAND>chkconfig</COMMAND> command. The specific command used is </PARAGRAPH>
<EXAMPLE>
chkconfig network on 
</EXAMPLE>
<PARAGRAPH>Rather than having each system service run continuously, <COMMAND>inetd</COMMAND> offers the services of these daemons on their behalf. When a request for one of the offered services arrives and is received by <COMMAND>inetd</COMMAND>, it spawns a child process according to the service requests (for example, <COMMAND>inetd</COMMAND> spawns <COMMAND>rlogind</COMMAND> for an <COMMAND>rlogin</COMMAND> request).</PARAGRAPH>
<PARAGRAPH>Typically, each new request for a particular service results in a new instance of the daemon that provides that service being spawned. That daemon remains in execution for the duration of the request and then terminates.</PARAGRAPH>
<PARAGRAPH>The Trusted IRIX/CMW version of <COMMAND>inetd</COMMAND> offers a special service. It can offer any of its services at all labels.The <INDEXTARGET ID="ch426"><!-- POSTPROCESSDATA: ch426|inetd command:services --><COMMAND>inetd</COMMAND> daemon can receive requests for any service at any label. Under Trusted IRIX/CMW, inetd can, for example, receive rlogin requests at any label from <COMMAND>dblow</COMMAND> to <COMMAND>msenhigh</COMMAND>/<COMMAND>mintlow</COMMAND>, and <COMMAND>inetd</COMMAND> spawns the appropriate daemon at a label matching that of the incoming request. Because of this service, most programs that run as spawned children of <COMMAND>inetd</COMMAND> do not have to be modified in any way to understand labels; they do not have to be made &ldquo;label cognizant." These programs, running as children of <COMMAND>inetd</COMMAND>, are invoked at the correct label in each instance by <COMMAND>inetd</COMMAND>.</PARAGRAPH>
<PARAGRAPH>Although they do not have to be made &ldquo;label cognizant,&rdquo; most of the child processes of <COMMAND>inetd</COMMAND> run as root, and have root access to the privilege of programs. All programs run by <COMMAND>inetd</COMMAND> must be within the TCB. The fact that a program or file is part of the TCB is signified to <COMMAND>inetd</COMMAND> by the program or file bearing the <COMMAND>dblow</COMMAND> label. The <COMMAND>inetd</COMMAND> daemon cannot (due to MAC) spawn a child process unless the program file for the process is labeled <COMMAND>dblow</COMMAND>. For example, the file <FILENAME>/usr/bsd/rlogind</FILENAME> is labeled <COMMAND>dblow</COMMAND>, so it can be run by <COMMAND>inetd</COMMAND>.</PARAGRAPH>
<PARAGRAPH>If a system administrator takes untrustworthy software, such as programs taken from other source bases or from other operating systems (for example, standard IRIX) and labels it <ITALICS>dblow</ITALICS>, thereby making it a part of the TCB, that system administrator is violating the integrity of the TCB and can open the system to security violations.</PARAGRAPH>
<PARAGRAPH>Not all network services are offered by <COMMAND>inetd</COMMAND>. Several notable exceptions are the <COMMAND>portmap</COMMAND> service offered by the <COMMAND>portmap</COMMAND> program, NFS, the X Window server, and <COMMAND>sendmail</COMMAND>. The <COMMAND>sendmail</COMMAND> and <COMMAND>portmap</COMMAND> services have been made label cognizant and offer services to clients at all labels. NFS uses the <ITALICS>nfsd</ITALICS> and <ITALICS>biod</ITALICS> servers. These are kernel processes and as such they are also a label-cognizant part of the Trusted IRIX/CMW kernel.</PARAGRAPH>
</SECTION1>
<SECTION1 LBL="" HELPID = ""><TITLE><XREFTARGET ID="95646">Miscellaneous Trusted Network Information</TITLE><PARAGRAPH>The following sections contain information useful to the administrator of a trusted network:</PARAGRAPH>
<BULLETLIST><BULLET><PARAGRAPH>The /etc/hosts.equiv and $HOME/.rhosts Files</PARAGRAPH>
</BULLET>
<BULLET><PARAGRAPH>Maintaining the System Audit Trail</PARAGRAPH>
</BULLET>
<BULLET><PARAGRAPH>NFS Under Trusted IRIX/CMW</PARAGRAPH>
</BULLET>
<BULLET><PARAGRAPH>Using Electronic Mail</PARAGRAPH>
</BULLET>
</BULLETLIST>
<SECTION2 LBL="" HELPID = ""><TITLE>The /etc/hosts.equiv and $HOME/.rhosts Files</TITLE><PARAGRAPH>Under Trusted IRIX/CMW, only the first field of the <FILENAME>/etc/hosts.equiv</FILENAME> and <FILENAME>$HOME/.rhosts</FILENAME> files is relevant to the system. The second field is ignored as a comment. This behavior places a restriction on the <COMMAND>rsh</COMMAND> and <COMMAND>rlogin</COMMAND> programs, which do not allow unchallenged access (access without demanding a password) unless the remote user name and user ID are exactly identical to the local user name and user ID. If a different name or user ID is used, the user is prompted for a password that authenticates the user's identity in the usual manner.</PARAGRAPH>
</SECTION2>
<SECTION2 LBL="" HELPID = ""><TITLE>Maintaining the System Audit Trail</TITLE><PARAGRAPH>For a network of several workstations, the audit trail can accumulate a considerable amount of data. The current estimate of audit information is that if all auditing is enabled, a typical workstation can expect to generate 10,000 bytes per second of audit information. Most systems are not able to store this information adequately on the computer's hard disk for a great length of time. It is imperative that a multi-workstation Trusted IRIX/CMW network have a secure and thorough electronic backup plan.<INDEXTARGET ID="ch427"><!-- POSTPROCESSDATA: ch427|networking:and the audit trail --></PARAGRAPH>
<PARAGRAPH>It is also imperative that the individual systems keep their system clocks synchronized. This is accomplished with the <COMMAND>timed</COMMAND> daemon. One system is the designated master time server. All the other systems on the network synchronize their clocks with the server. </PARAGRAPH>
<PARAGRAPH>The reason that individual stations must keep their clocks synchronized is so that the combined system audit trail is accurate. If attempts to compromise system security are happening, the auditor needs to know the exact sequence of events on each system, with respect to every other system on the network. The way to maintain order in the audit logs is by running <COMMAND>timed</COMMAND>.</PARAGRAPH>
<PARAGRAPH>Complete information on running <COMMAND>timed</COMMAND> is found in the <REFPAGE>timed</REFPAGE>(1M) reference page.</PARAGRAPH>
</SECTION2>
<SECTION2 LBL="" HELPID = ""><TITLE>NFS Under Trusted IRIX/CMW</TITLE><PARAGRAPH>Trusted IRIX/CMW provides full support for the NFS version 3 filesystem-sharing software. NFS is an optional software product. For a complete discussion of NFS, see your standard IRIX NFS documentation. </PARAGRAPH>
<PARAGRAPH>The base NFS protocol does not support MAC labels, ACLs, or capability sets on files. This information is transferred over the trusted network using SAMP and SATMP as with any other network traffic, as described above. The <REFPAGE>mount</REFPAGE>(1) reference page describes how to mount filesystems using NFS.</PARAGRAPH>
</SECTION2>
<SECTION2 LBL="" HELPID = ""><TITLE>Using Electronic Mail</TITLE><PARAGRAPH>Electronic mail service is provided under Trusted IRIX/CMW. There are some restrictions, however, to the use of mail.</PARAGRAPH>
<SECTION3 LBL="" HELPID = ""><TITLE>Labeled Mail</TITLE><PARAGRAPH>As with all other data objects on the system, electronic mail is labeled. When someone sends mail, the mail message inherits the sender's current label. According to the rules governing Mandatory Access Control, the recipient of the mail must be running at a correspondingly equal or dominant label to read the mail sent. If the recipient is running at a lower label, he or she must change labels to an appropriate label to be able to read the mail. If the sender is running at a label dominating the recipient's maximum label, the recipient cannot read the mail or even be notified of its existence until his or her available labels are expanded to include the label of the mail.</PARAGRAPH>
<PARAGRAPH>MAC protection extends into replying to mail as well as reading it. If someone receives a message from a user at a lower label, the recipient is able to read the mail, but if the recipient responds to the mail, the system attaches the higher label of the recipient to the response. If the original sender is not cleared for the recipient's label, he or she cannot  read the response. This policy prevents accidental &ldquo;writedown&rdquo; of information from the higher label to a lower label.</PARAGRAPH>
<PARAGRAPH>To send mail across a gateway onto a unlabeled network, a user must send the mail at the assigned label for the unlabeled network. All mail traffic arriving from an unlabeled network is, of course, labeled with the label assigned to that network.</PARAGRAPH>
</SECTION3>
<SECTION3 LBL="" HELPID = ""><TITLE>Using sendmail With Trusted IRIX/CMW</TITLE><PARAGRAPH>The mail system is driven on each system by a daemon program called <COMMAND>sendmail</COMMAND>. The <COMMAND>sendmail</COMMAND> program is a mail routing clearinghouse. When you use your preferred mailer, such as <COMMAND>Mail</COMMAND>, <COMMAND>sendmail</COMMAND> takes the message you have created and prepares it for the destination system. Then <COMMAND>sendmail</COMMAND> calls the appropriate utilities to deliver the mail locally or queues it for transmission. The<COMMAND>&space;sendmail </COMMAND>daemon has been made label cognizant for Trusted IRIX/CMW. For more general discussion of<COMMAND>&space;sendmail</COMMAND>, refer to <EXTREF IDREF="97829" BOOK="IA_NetwkMail" FILE="" HDG="97829" INFO="">IRIX Admin: Networking and Mail</EXTREF>
.</PARAGRAPH>
</SECTION3>
</SECTION2>
</SECTION1>
</CHAPTER>
